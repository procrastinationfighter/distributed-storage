use tokio::io::AsyncWriteExt;
use rand::{thread_rng, Rng};
use assignment_2_solution::{deserialize_register_command, serialize_register_command, ClientCommandHeader, ClientRegisterCommand, ClientRegisterCommandContent, RegisterCommand, SystemCommandHeader, SystemRegisterCommand, SystemRegisterCommandContent, SectorVec, MAGIC_NUMBER};
use assignment_2_test_utils::transfer::*;
use ntest::{assert_false, timeout};
use uuid::Uuid;
use tokio::net::{TcpListener, TcpStream};

#[tokio::test]
#[timeout(200)]
async fn serialize_deserialize_is_identity() {
    // given
    let request_identifier = 7;
    let sector_idx = 8;
    let register_cmd = RegisterCommand::Client(ClientRegisterCommand {
        header: ClientCommandHeader {
            request_identifier,
            sector_idx,
        },
        content: ClientRegisterCommandContent::Read,
    });
    let mut sink: Vec<u8> = Vec::new();

    // when
    serialize_register_command(&register_cmd, &mut sink, &[0x00_u8; 32])
        .await
        .expect("Could not serialize?");
    let mut slice: &[u8] = &sink[..];
    let data_read: &mut (dyn tokio::io::AsyncRead + Send + Unpin) = &mut slice;
    let (deserialized_cmd, hmac_valid) =
        deserialize_register_command(data_read, &[0x00_u8; 64], &[0x00_u8; 32])
            .await
            .expect("Could not deserialize");

    // then
    assert!(hmac_valid);
    match deserialized_cmd {
        RegisterCommand::Client(ClientRegisterCommand {
                                    header,
                                    content: ClientRegisterCommandContent::Read,
                                }) => {
            assert_eq!(header.sector_idx, sector_idx);
            assert_eq!(header.request_identifier, request_identifier);
        }
        _ => panic!("Expected Read command"),
    }
}

#[tokio::test]
#[timeout(200)]
async fn serialized_read_proc_cmd_has_correct_format() {
    // given
    let sector_idx = 4525787855454_u64;
    let process_identifier = 147_u8;
    let msg_ident = [7; 16];

    let read_proc_cmd = RegisterCommand::System(SystemRegisterCommand {
        header: SystemCommandHeader {
            process_identifier,
            msg_ident: Uuid::from_slice(&msg_ident).unwrap(),
            sector_idx,
        },
        content: SystemRegisterCommandContent::ReadProc,
    });
    let mut serialized: Vec<u8> = Vec::new();

    // when
    serialize_register_command(&read_proc_cmd, &mut serialized, &[0x00_u8; 64])
        .await
        .expect("Could not write to vector?");
    serialized.truncate(serialized.len() - 32);

    // then
    assert_eq!(serialized.len(), 32);
    assert_system_cmd_header(
        serialized.as_slice(),
        &msg_ident,
        process_identifier,
        3,
        sector_idx,
    );
}

const CUSTOM_HMAC_CLIENT_KEY: [u8; 32] =
    [124, 8, 127, 113, 96, 67, 204, 24,
     17, 150, 41, 83, 227, 15, 199, 211,
     162, 45, 14, 79, 201, 131, 198, 60,
     51, 89, 51, 150, 199, 202, 235, 16];

const CUSTOM_HMAC_SYSTEM_KEY: [u8; 64] =
    [151, 74, 37, 114, 71, 173, 188, 126,
        220, 102, 230, 22, 208, 167, 143, 243,
        155, 19, 223, 8, 78, 218, 159, 185,
        15, 72, 218, 12, 157, 21, 204, 128,
        119, 84, 198, 188, 142, 87, 119, 198,
        151, 63, 228, 208, 198, 199, 121, 141,
        246, 100, 210, 98, 159, 169, 79, 192,
        100, 158, 181, 124, 125, 187, 45, 179];

fn get_random_sector() -> Vec<u8> {
    let mut sector = [0; 4096];
    thread_rng().fill(&mut sector[..]);
    sector.to_vec()
}

#[tokio::test]
#[timeout(200)]
async fn serialize_deserialize_is_identity_client_read() {
    // given
    let request_identifier = 12786636217375856365_u64;
    let sector_idx = 1615701_u64;
    let register_cmd = RegisterCommand::Client(ClientRegisterCommand {
        header: ClientCommandHeader {
            request_identifier,
            sector_idx,
        },
        content: ClientRegisterCommandContent::Read,
    });
    let mut sink: Vec<u8> = Vec::new();

    // when
    serialize_register_command(&register_cmd, &mut sink, &CUSTOM_HMAC_CLIENT_KEY)
        .await
        .expect("Could not serialize?");
    let mut slice: &[u8] = &sink[..];
    let data_read: &mut (dyn tokio::io::AsyncRead + Send + Unpin) = &mut slice;
    let (deserialized_cmd, hmac_valid) =
        deserialize_register_command(data_read, &CUSTOM_HMAC_SYSTEM_KEY, &CUSTOM_HMAC_CLIENT_KEY)
            .await
            .expect("Could not deserialize");

    // then
    assert!(hmac_valid);
    match deserialized_cmd {
        RegisterCommand::Client(ClientRegisterCommand {
                                    header,
                                    content: ClientRegisterCommandContent::Read,
                                }) => {
            assert_eq!(header.sector_idx, sector_idx);
            assert_eq!(header.request_identifier, request_identifier);
        }
        _ => panic!("Expected Read command"),
    }
}

#[tokio::test]
#[timeout(200)]
async fn serialize_deserialize_is_identity_client_write() {
    // given
    let request_identifier = 12786636217375856365_u64;
    let sector_idx = 1615701_u64;
    let sector = get_random_sector();
    let register_cmd = RegisterCommand::Client(ClientRegisterCommand {
        header: ClientCommandHeader {
            request_identifier,
            sector_idx,
        },
        content: ClientRegisterCommandContent::Write {
            data: SectorVec(sector.clone()),
        },
    });
    let mut sink: Vec<u8> = Vec::new();

    // when
    serialize_register_command(&register_cmd, &mut sink, &CUSTOM_HMAC_CLIENT_KEY)
        .await
        .expect("Could not serialize?");
    let mut slice: &[u8] = &sink[..];
    let data_read: &mut (dyn tokio::io::AsyncRead + Send + Unpin) = &mut slice;
    let (deserialized_cmd, hmac_valid) =
        deserialize_register_command(data_read, &CUSTOM_HMAC_SYSTEM_KEY, &CUSTOM_HMAC_CLIENT_KEY)
            .await
            .expect("Could not deserialize");

    // then
    assert!(hmac_valid);
    match deserialized_cmd {
        RegisterCommand::Client(ClientRegisterCommand {
                                    header,
                                    content: ClientRegisterCommandContent::Write { data },
                                }) => {
            assert_eq!(header.sector_idx, sector_idx);
            assert_eq!(header.request_identifier, request_identifier);
            assert_eq!(data.0, sector);
        }
        _ => panic!("Expected Write command"),
    }
}

#[tokio::test]
#[timeout(200)]
async fn serialize_deserialize_is_identity_system_read_proc() {
    // given
    let process_identifier = 205_u8;
    let msg_ident = Uuid::new_v4();
    let sector_idx = 1615701_u64;
    let register_cmd = RegisterCommand::System(SystemRegisterCommand {
        header: SystemCommandHeader {
            process_identifier,
            msg_ident,
            sector_idx
        },
        content: SystemRegisterCommandContent::ReadProc,
    });
    let mut sink: Vec<u8> = Vec::new();

    // when
    serialize_register_command(&register_cmd, &mut sink, &CUSTOM_HMAC_SYSTEM_KEY)
        .await
        .expect("Could not serialize?");
    let mut slice: &[u8] = &sink[..];
    let data_read: &mut (dyn tokio::io::AsyncRead + Send + Unpin) = &mut slice;
    let (deserialized_cmd, hmac_valid) =
        deserialize_register_command(data_read, &CUSTOM_HMAC_SYSTEM_KEY, &CUSTOM_HMAC_CLIENT_KEY)
            .await
            .expect("Could not deserialize");

    // then
    assert!(hmac_valid);
    match deserialized_cmd {
        RegisterCommand::System(SystemRegisterCommand {
                                    header,
                                    content: SystemRegisterCommandContent::ReadProc,
                                }) => {
            assert_eq!(header.process_identifier, process_identifier);
            assert_eq!(header.msg_ident, msg_ident);
            assert_eq!(header.sector_idx, sector_idx);
        }
        _ => panic!("Expected Read Proc command"),
    }
}

#[tokio::test]
#[timeout(200)]
async fn serialize_deserialize_is_identity_system_value() {
    // given
    let process_identifier = 205_u8;
    let msg_ident = Uuid::new_v4();
    let sector_idx = 1615701_u64;
    let timestamp = 12786636217375856365_u64;
    let write_rank = 215_u8;
    let sector = get_random_sector();
    let register_cmd = RegisterCommand::System(SystemRegisterCommand {
        header: SystemCommandHeader {
            process_identifier,
            msg_ident,
            sector_idx
        },
        content: SystemRegisterCommandContent::Value {
            timestamp,
            write_rank,
            sector_data: SectorVec(sector.clone()),
        },
    });
    let mut sink: Vec<u8> = Vec::new();

    // when
    serialize_register_command(&register_cmd, &mut sink, &CUSTOM_HMAC_SYSTEM_KEY)
        .await
        .expect("Could not serialize?");
    let mut slice: &[u8] = &sink[..];
    let data_read: &mut (dyn tokio::io::AsyncRead + Send + Unpin) = &mut slice;
    let (deserialized_cmd, hmac_valid) =
        deserialize_register_command(data_read, &CUSTOM_HMAC_SYSTEM_KEY, &CUSTOM_HMAC_CLIENT_KEY)
            .await
            .expect("Could not deserialize");

    // then
    assert!(hmac_valid);
    match deserialized_cmd {
        RegisterCommand::System(SystemRegisterCommand {
                                    header,
                                    content: SystemRegisterCommandContent::Value {
                                        timestamp: timestamp_deserialized,
                                        write_rank: write_rank_deserialized,
                                        sector_data: sector_data_deserialized,
                                    },
                                }) => {
            assert_eq!(header.process_identifier, process_identifier);
            assert_eq!(header.msg_ident, msg_ident);
            assert_eq!(header.sector_idx, sector_idx);
            assert_eq!(timestamp_deserialized, timestamp);
            assert_eq!(write_rank_deserialized, write_rank);
            assert_eq!(sector_data_deserialized.0, sector);
        }
        _ => panic!("Expected Value command"),
    }
}

#[tokio::test]
#[timeout(200)]
async fn serialize_deserialize_is_identity_system_write_proc() {
    // given
    let process_identifier = 205_u8;
    let msg_ident = Uuid::new_v4();
    let sector_idx = 1615701_u64;
    let timestamp = 12786636217375856365_u64;
    let write_rank = 215_u8;
    let sector = get_random_sector();
    let register_cmd = RegisterCommand::System(SystemRegisterCommand {
        header: SystemCommandHeader {
            process_identifier,
            msg_ident,
            sector_idx
        },
        content: SystemRegisterCommandContent::WriteProc {
            timestamp,
            write_rank,
            data_to_write: SectorVec(sector.clone()),
        },
    });
    let mut sink: Vec<u8> = Vec::new();

    // when
    serialize_register_command(&register_cmd, &mut sink, &CUSTOM_HMAC_SYSTEM_KEY)
        .await
        .expect("Could not serialize?");
    let mut slice: &[u8] = &sink[..];
    let data_read: &mut (dyn tokio::io::AsyncRead + Send + Unpin) = &mut slice;
    let (deserialized_cmd, hmac_valid) =
        deserialize_register_command(data_read, &CUSTOM_HMAC_SYSTEM_KEY, &CUSTOM_HMAC_CLIENT_KEY)
            .await
            .expect("Could not deserialize");

    // then
    assert!(hmac_valid);
    match deserialized_cmd {
        RegisterCommand::System(SystemRegisterCommand {
                                    header,
                                    content: SystemRegisterCommandContent::WriteProc {
                                        timestamp: timestamp_deserialized,
                                        write_rank: write_rank_deserialized,
                                        data_to_write: data_to_write_deserialized,
                                    },
                                }) => {
            assert_eq!(header.process_identifier, process_identifier);
            assert_eq!(header.msg_ident, msg_ident);
            assert_eq!(header.sector_idx, sector_idx);
            assert_eq!(timestamp_deserialized, timestamp);
            assert_eq!(write_rank_deserialized, write_rank);
            assert_eq!(data_to_write_deserialized.0, sector);
        }
        _ => panic!("Expected Write Proc command"),
    }
}

#[tokio::test]
#[timeout(200)]
async fn serialize_deserialize_is_identity_system_ack() {
    // given
    let process_identifier = 205_u8;
    let msg_ident = Uuid::new_v4();
    let sector_idx = 1615701_u64;
    let register_cmd = RegisterCommand::System(SystemRegisterCommand {
        header: SystemCommandHeader {
            process_identifier,
            msg_ident,
            sector_idx
        },
        content: SystemRegisterCommandContent::Ack,
    });
    let mut sink: Vec<u8> = Vec::new();

    // when
    serialize_register_command(&register_cmd, &mut sink, &CUSTOM_HMAC_SYSTEM_KEY)
        .await
        .expect("Could not serialize?");
    let mut slice: &[u8] = &sink[..];
    let data_read: &mut (dyn tokio::io::AsyncRead + Send + Unpin) = &mut slice;
    let (deserialized_cmd, hmac_valid) =
        deserialize_register_command(data_read, &CUSTOM_HMAC_SYSTEM_KEY, &CUSTOM_HMAC_CLIENT_KEY)
            .await
            .expect("Could not deserialize");

    // then
    assert!(hmac_valid);
    match deserialized_cmd {
        RegisterCommand::System(SystemRegisterCommand {
                                    header,
                                    content: SystemRegisterCommandContent::Ack,
                                }) => {
            assert_eq!(header.process_identifier, process_identifier);
            assert_eq!(header.msg_ident, msg_ident);
            assert_eq!(header.sector_idx, sector_idx);
        }
        _ => panic!("Expected Ack command"),
    }
}

const CUSTOM_UUID_BYTES: [u8; 16] = [250, 105, 14, 18, 145, 80, 69, 90, 165, 16, 247, 215, 234, 71, 105, 162];
const CUSTOM_SECTOR: [u8; 4096] = [238, 175, 7, 29, 100, 113, 98, 36, 225, 187, 114, 140, 179, 254, 24, 78, 41, 59, 2, 73, 200, 64, 133, 146, 27, 160, 243, 44, 228, 184, 174, 45, 16, 116, 47, 20, 189, 146, 194, 161, 179, 80, 99, 116, 117, 93, 111, 209, 243, 133, 116, 165, 122, 222, 197, 145, 0, 97, 131, 180, 133, 178, 122, 122, 54, 2, 188, 152, 144, 167, 112, 113, 225, 215, 86, 198, 56, 178, 5, 222, 228, 120, 239, 233, 76, 54, 147, 241, 147, 35, 144, 83, 238, 163, 43, 1, 1, 12, 40, 154, 84, 160, 115, 72, 210, 161, 236, 80, 100, 202, 3, 87, 23, 135, 59, 188, 70, 4, 17, 89, 80, 57, 188, 13, 24, 9, 229, 185, 200, 173, 136, 65, 243, 122, 2, 168, 102, 134, 81, 177, 119, 129, 126, 61, 213, 252, 17, 225, 244, 8, 123, 55, 159, 81, 30, 235, 228, 158, 150, 196, 240, 204, 84, 62, 130, 57, 157, 73, 40, 255, 224, 246, 98, 234, 241, 228, 77, 147, 62, 233, 35, 2, 130, 29, 128, 59, 0, 190, 251, 137, 113, 226, 113, 38, 163, 130, 65, 240, 97, 212, 25, 14, 232, 201, 136, 196, 71, 229, 213, 147, 51, 155, 46, 252, 98, 145, 19, 105, 77, 105, 248, 129, 18, 241, 94, 215, 175, 81, 141, 59, 239, 114, 172, 197, 130, 154, 127, 11, 66, 246, 145, 19, 171, 63, 61, 84, 160, 190, 120, 29, 213, 129, 71, 222, 87, 35, 194, 28, 177, 91, 45, 199, 42, 102, 10, 134, 131, 81, 207, 114, 137, 244, 50, 3, 250, 19, 147, 146, 221, 80, 34, 252, 206, 61, 218, 114, 181, 113, 215, 245, 63, 182, 14, 216, 105, 18, 27, 5, 35, 99, 64, 86, 211, 194, 38, 81, 114, 252, 111, 153, 67, 187, 172, 240, 195, 177, 98, 56, 131, 202, 70, 128, 38, 20, 145, 80, 89, 111, 71, 184, 109, 151, 226, 233, 125, 184, 249, 216, 204, 90, 145, 149, 52, 204, 21, 58, 132, 88, 81, 231, 105, 19, 255, 150, 54, 15, 79, 187, 144, 34, 28, 18, 24, 206, 238, 15, 92, 223, 43, 219, 182, 47, 243, 60, 155, 70, 148, 189, 133, 173, 196, 159, 209, 248, 197, 252, 91, 214, 239, 34, 129, 62, 249, 13, 183, 186, 181, 30, 210, 210, 245, 254, 74, 224, 94, 96, 16, 7, 4, 50, 81, 143, 73, 74, 115, 117, 22, 248, 78, 142, 131, 74, 210, 243, 105, 49, 151, 25, 244, 249, 97, 241, 123, 207, 56, 156, 176, 52, 189, 159, 16, 205, 90, 56, 212, 123, 111, 40, 215, 253, 219, 190, 30, 63, 155, 210, 85, 120, 111, 130, 31, 89, 210, 14, 56, 220, 228, 71, 41, 138, 201, 249, 71, 236, 208, 224, 176, 183, 116, 21, 32, 91, 53, 205, 103, 25, 159, 176, 32, 162, 65, 165, 239, 236, 186, 218, 143, 205, 18, 220, 152, 88, 37, 34, 110, 68, 104, 63, 51, 88, 85, 179, 45, 176, 235, 64, 237, 37, 155, 205, 79, 165, 192, 200, 214, 78, 153, 179, 255, 241, 178, 57, 181, 232, 245, 168, 12, 194, 137, 84, 209, 3, 101, 170, 172, 131, 161, 55, 7, 170, 200, 99, 22, 176, 195, 229, 85, 118, 110, 227, 157, 101, 183, 246, 135, 8, 19, 178, 214, 32, 86, 113, 104, 38, 128, 75, 219, 230, 158, 198, 53, 26, 231, 238, 75, 246, 224, 181, 61, 57, 78, 81, 139, 245, 244, 241, 144, 160, 49, 94, 211, 18, 222, 250, 91, 178, 31, 103, 1, 161, 13, 130, 133, 145, 126, 74, 127, 241, 86, 176, 249, 65, 170, 215, 213, 145, 239, 216, 5, 43, 47, 99, 224, 116, 167, 226, 108, 136, 151, 36, 2, 63, 91, 244, 246, 211, 37, 179, 250, 125, 46, 69, 234, 57, 66, 186, 51, 226, 223, 227, 139, 137, 25, 18, 251, 79, 37, 144, 212, 86, 62, 249, 187, 135, 171, 7, 141, 127, 28, 103, 78, 124, 128, 71, 140, 36, 71, 155, 227, 68, 208, 185, 58, 167, 164, 99, 94, 26, 204, 115, 72, 190, 203, 101, 212, 188, 76, 116, 231, 35, 131, 76, 109, 227, 79, 179, 98, 254, 76, 80, 64, 209, 1, 233, 110, 163, 86, 218, 175, 73, 111, 5, 93, 110, 161, 46, 196, 109, 145, 58, 164, 183, 240, 209, 41, 159, 102, 137, 238, 88, 49, 16, 230, 164, 133, 247, 128, 174, 3, 202, 206, 143, 255, 217, 243, 137, 13, 126, 77, 97, 235, 161, 99, 227, 106, 252, 178, 117, 40, 45, 205, 154, 134, 151, 125, 101, 161, 79, 134, 169, 21, 179, 87, 232, 164, 21, 85, 26, 198, 143, 118, 22, 238, 244, 23, 198, 91, 48, 199, 217, 201, 99, 114, 210, 251, 70, 189, 141, 225, 139, 83, 209, 126, 101, 162, 94, 90, 40, 158, 49, 25, 159, 237, 12, 158, 86, 170, 241, 63, 103, 150, 12, 71, 188, 31, 184, 119, 25, 206, 26, 218, 47, 199, 245, 131, 229, 173, 70, 223, 231, 204, 87, 91, 26, 28, 93, 173, 174, 169, 139, 45, 106, 57, 142, 174, 18, 12, 146, 61, 249, 184, 171, 134, 67, 64, 4, 84, 165, 248, 242, 50, 236, 178, 18, 115, 158, 228, 38, 64, 28, 230, 31, 108, 162, 238, 108, 120, 76, 42, 85, 151, 207, 238, 121, 60, 123, 244, 15, 101, 108, 193, 88, 206, 51, 15, 220, 59, 28, 217, 2, 100, 191, 60, 31, 238, 172, 163, 166, 124, 190, 237, 22, 123, 147, 61, 244, 115, 149, 142, 233, 206, 4, 47, 1, 40, 223, 240, 32, 165, 209, 118, 183, 4, 222, 60, 169, 2, 227, 77, 163, 171, 165, 69, 85, 82, 146, 116, 173, 170, 172, 117, 8, 202, 122, 50, 54, 134, 167, 175, 17, 192, 10, 88, 19, 203, 38, 108, 240, 13, 49, 227, 85, 74, 239, 176, 121, 172, 1, 235, 48, 117, 212, 103, 133, 182, 60, 9, 0, 71, 21, 5, 112, 52, 96, 190, 78, 200, 220, 86, 28, 232, 21, 171, 228, 136, 49, 41, 206, 116, 70, 176, 165, 130, 75, 254, 242, 167, 124, 64, 98, 215, 210, 224, 1, 247, 132, 58, 144, 160, 58, 103, 172, 76, 15, 198, 73, 254, 248, 147, 198, 220, 122, 47, 188, 216, 126, 62, 18, 15, 1, 84, 36, 161, 250, 48, 158, 92, 90, 168, 227, 100, 99, 201, 174, 161, 190, 228, 128, 247, 99, 207, 24, 155, 72, 170, 6, 155, 70, 125, 2, 158, 178, 37, 19, 86, 21, 246, 223, 55, 132, 92, 82, 236, 168, 136, 194, 226, 75, 199, 6, 155, 85, 50, 88, 94, 49, 84, 26, 194, 160, 71, 121, 110, 133, 121, 47, 210, 162, 152, 160, 173, 223, 9, 33, 244, 153, 159, 198, 15, 12, 150, 163, 100, 234, 91, 122, 86, 97, 206, 38, 170, 254, 65, 103, 28, 20, 23, 176, 150, 31, 176, 147, 70, 79, 94, 175, 179, 240, 56, 10, 154, 147, 143, 33, 76, 147, 61, 72, 45, 155, 155, 186, 63, 34, 71, 168, 164, 119, 102, 84, 228, 206, 122, 74, 214, 207, 246, 54, 227, 230, 50, 16, 207, 70, 253, 108, 98, 127, 7, 150, 193, 135, 46, 182, 166, 163, 127, 140, 205, 75, 157, 22, 0, 75, 154, 26, 109, 228, 171, 204, 58, 208, 80, 134, 180, 44, 87, 108, 86, 58, 77, 142, 164, 141, 47, 52, 12, 207, 173, 36, 169, 60, 186, 154, 205, 75, 201, 244, 137, 120, 67, 24, 42, 33, 124, 242, 61, 31, 147, 23, 11, 209, 215, 127, 133, 229, 135, 204, 129, 148, 189, 95, 4, 216, 115, 106, 114, 173, 245, 101, 238, 42, 26, 61, 57, 63, 90, 157, 50, 111, 118, 71, 67, 211, 135, 28, 31, 91, 151, 181, 117, 251, 255, 114, 204, 89, 205, 240, 145, 225, 75, 131, 175, 84, 196, 179, 246, 168, 180, 63, 152, 73, 255, 177, 41, 193, 204, 16, 64, 35, 201, 250, 163, 126, 145, 92, 4, 74, 190, 46, 82, 151, 164, 215, 250, 146, 133, 66, 178, 97, 50, 228, 67, 220, 28, 27, 221, 182, 118, 252, 100, 158, 83, 33, 177, 175, 206, 40, 47, 116, 179, 214, 111, 245, 213, 137, 144, 183, 6, 131, 138, 224, 12, 225, 188, 173, 117, 57, 185, 198, 131, 170, 149, 0, 117, 253, 178, 49, 236, 244, 163, 127, 58, 157, 219, 1, 106, 182, 161, 100, 62, 59, 169, 23, 163, 221, 52, 132, 216, 221, 102, 251, 200, 168, 99, 89, 85, 164, 90, 119, 98, 107, 78, 1, 85, 203, 233, 0, 85, 114, 58, 238, 88, 32, 47, 241, 222, 251, 40, 25, 187, 83, 2, 143, 182, 134, 40, 99, 94, 16, 92, 35, 25, 150, 165, 230, 129, 122, 24, 191, 50, 5, 32, 148, 175, 232, 179, 2, 70, 8, 66, 13, 104, 27, 24, 4, 60, 133, 57, 162, 97, 189, 39, 132, 228, 165, 193, 172, 227, 192, 239, 57, 171, 94, 120, 178, 105, 27, 92, 169, 65, 25, 250, 69, 231, 133, 32, 139, 217, 111, 130, 13, 106, 95, 102, 248, 116, 13, 187, 192, 68, 202, 181, 16, 38, 101, 56, 90, 230, 2, 154, 16, 148, 119, 144, 180, 194, 223, 218, 186, 0, 181, 160, 24, 31, 245, 61, 126, 86, 148, 79, 143, 117, 251, 205, 232, 28, 69, 199, 117, 126, 191, 23, 191, 213, 36, 196, 124, 45, 201, 4, 215, 158, 59, 124, 223, 26, 19, 220, 56, 44, 94, 202, 85, 12, 135, 244, 110, 44, 59, 112, 21, 229, 119, 121, 132, 133, 114, 251, 148, 204, 208, 209, 154, 104, 115, 73, 38, 144, 153, 51, 192, 63, 150, 144, 146, 66, 81, 85, 232, 17, 1, 218, 188, 199, 194, 249, 250, 105, 14, 92, 212, 238, 134, 104, 75, 132, 197, 120, 187, 170, 191, 142, 104, 0, 242, 121, 55, 132, 186, 143, 225, 184, 227, 18, 2, 102, 84, 237, 115, 105, 230, 11, 202, 255, 226, 9, 155, 53, 131, 45, 52, 169, 41, 143, 250, 248, 141, 104, 182, 52, 41, 116, 120, 1, 27, 254, 131, 254, 175, 123, 154, 43, 239, 185, 204, 15, 126, 152, 254, 119, 169, 209, 233, 230, 180, 194, 125, 58, 138, 16, 180, 123, 65, 172, 140, 8, 151, 154, 182, 138, 140, 112, 55, 104, 239, 182, 82, 75, 46, 82, 110, 215, 7, 242, 7, 209, 127, 213, 192, 135, 202, 17, 49, 201, 123, 243, 62, 63, 85, 73, 183, 150, 183, 94, 199, 183, 43, 109, 87, 98, 2, 251, 108, 170, 114, 128, 52, 43, 232, 110, 226, 68, 3, 65, 98, 180, 27, 24, 223, 22, 252, 144, 162, 99, 176, 188, 143, 160, 244, 111, 214, 177, 230, 151, 41, 210, 17, 204, 25, 119, 165, 231, 90, 4, 45, 98, 218, 40, 241, 196, 143, 96, 136, 169, 199, 149, 158, 41, 56, 69, 163, 234, 188, 210, 39, 254, 213, 48, 249, 153, 239, 58, 5, 228, 125, 119, 207, 180, 87, 6, 99, 2, 26, 158, 79, 67, 188, 253, 200, 253, 167, 64, 119, 163, 80, 184, 7, 178, 26, 89, 68, 36, 131, 9, 33, 64, 159, 100, 109, 38, 18, 77, 121, 1, 26, 210, 192, 210, 110, 135, 47, 24, 90, 145, 105, 57, 131, 131, 225, 243, 40, 212, 20, 229, 19, 111, 79, 142, 171, 55, 104, 60, 113, 182, 10, 192, 100, 190, 112, 24, 247, 90, 28, 96, 156, 88, 112, 173, 144, 223, 117, 131, 201, 122, 186, 11, 118, 79, 182, 247, 37, 231, 146, 117, 242, 194, 113, 188, 210, 239, 121, 231, 100, 54, 229, 240, 98, 215, 41, 190, 108, 64, 43, 189, 9, 188, 209, 64, 82, 139, 6, 144, 83, 35, 139, 95, 222, 159, 173, 3, 1, 31, 130, 255, 75, 162, 125, 4, 62, 82, 1, 78, 51, 142, 193, 249, 110, 171, 159, 154, 20, 230, 167, 127, 106, 94, 7, 192, 0, 250, 11, 150, 47, 104, 165, 215, 100, 98, 171, 16, 145, 29, 91, 228, 203, 4, 41, 211, 127, 12, 229, 195, 118, 55, 121, 17, 42, 173, 63, 16, 155, 128, 37, 244, 235, 190, 140, 127, 204, 4, 124, 13, 252, 52, 146, 231, 8, 91, 251, 72, 79, 116, 7, 167, 152, 221, 133, 137, 127, 151, 28, 253, 93, 252, 253, 49, 13, 27, 111, 174, 235, 69, 148, 93, 200, 46, 228, 228, 95, 207, 200, 109, 166, 138, 254, 199, 127, 155, 142, 225, 28, 49, 107, 222, 126, 140, 75, 129, 86, 53, 42, 148, 75, 150, 109, 138, 28, 198, 142, 111, 160, 181, 204, 119, 77, 121, 150, 4, 54, 50, 153, 144, 182, 208, 124, 223, 140, 97, 29, 241, 230, 150, 144, 75, 74, 75, 247, 249, 13, 234, 191, 54, 180, 38, 66, 40, 213, 109, 17, 36, 223, 86, 45, 57, 115, 12, 143, 68, 160, 152, 199, 237, 18, 67, 167, 162, 251, 121, 69, 34, 46, 34, 28, 60, 35, 65, 209, 86, 136, 88, 188, 115, 9, 228, 202, 69, 59, 153, 70, 101, 185, 204, 119, 13, 142, 213, 246, 39, 4, 194, 167, 185, 198, 165, 222, 8, 83, 185, 213, 35, 234, 182, 113, 118, 177, 147, 249, 244, 52, 230, 235, 53, 173, 121, 123, 148, 67, 242, 187, 178, 144, 59, 196, 8, 199, 159, 41, 89, 72, 64, 115, 124, 83, 3, 245, 176, 199, 50, 37, 226, 132, 188, 81, 245, 178, 86, 178, 164, 120, 2, 113, 130, 208, 142, 70, 82, 159, 180, 172, 35, 111, 178, 202, 241, 177, 230, 125, 116, 154, 81, 250, 217, 27, 202, 210, 18, 56, 97, 198, 108, 161, 227, 70, 212, 43, 87, 10, 149, 244, 105, 27, 66, 79, 236, 64, 231, 119, 24, 34, 174, 151, 50, 33, 98, 173, 76, 198, 241, 54, 24, 176, 72, 165, 159, 230, 58, 209, 178, 62, 145, 201, 57, 190, 221, 150, 214, 193, 155, 85, 194, 61, 178, 223, 143, 173, 185, 63, 187, 193, 190, 21, 36, 231, 89, 92, 69, 0, 106, 139, 255, 109, 33, 45, 139, 92, 1, 212, 123, 126, 190, 218, 238, 247, 109, 68, 28, 161, 179, 239, 236, 253, 63, 23, 34, 48, 11, 15, 51, 28, 108, 190, 215, 30, 206, 12, 185, 62, 40, 114, 43, 198, 229, 110, 65, 23, 152, 9, 181, 118, 16, 188, 153, 132, 242, 95, 7, 106, 95, 65, 123, 107, 36, 34, 250, 92, 114, 108, 72, 98, 179, 62, 137, 125, 162, 18, 178, 22, 140, 57, 91, 170, 20, 143, 118, 24, 146, 168, 212, 51, 234, 94, 65, 248, 233, 120, 245, 163, 19, 162, 215, 101, 219, 39, 113, 110, 46, 150, 53, 243, 139, 11, 91, 44, 83, 106, 213, 125, 221, 98, 19, 5, 187, 14, 70, 62, 190, 60, 240, 151, 97, 228, 186, 0, 90, 91, 243, 140, 246, 249, 188, 233, 90, 118, 14, 254, 216, 144, 102, 9, 115, 214, 3, 17, 199, 138, 62, 131, 88, 238, 22, 169, 104, 149, 76, 150, 95, 233, 203, 71, 248, 115, 210, 27, 39, 165, 159, 200, 9, 71, 6, 239, 31, 210, 14, 200, 141, 163, 169, 54, 30, 137, 203, 227, 215, 61, 206, 242, 174, 86, 202, 65, 159, 7, 182, 245, 115, 8, 53, 33, 1, 62, 67, 126, 45, 126, 71, 239, 216, 147, 182, 111, 65, 255, 152, 238, 102, 196, 117, 19, 72, 183, 235, 41, 157, 105, 129, 118, 148, 85, 68, 234, 93, 226, 17, 176, 14, 178, 62, 135, 128, 145, 164, 50, 73, 47, 109, 101, 110, 155, 180, 139, 25, 57, 90, 144, 66, 60, 6, 190, 71, 251, 137, 45, 76, 24, 201, 169, 252, 0, 84, 233, 153, 21, 115, 89, 32, 125, 164, 85, 237, 76, 84, 69, 152, 125, 253, 231, 203, 81, 171, 116, 115, 102, 102, 66, 83, 205, 42, 188, 219, 141, 74, 109, 214, 166, 29, 165, 77, 159, 202, 213, 165, 172, 58, 97, 94, 55, 98, 21, 72, 130, 150, 165, 212, 42, 151, 255, 67, 34, 236, 87, 113, 221, 8, 245, 204, 94, 238, 192, 0, 136, 74, 123, 178, 15, 2, 214, 106, 160, 144, 214, 153, 76, 196, 125, 223, 173, 104, 90, 9, 239, 131, 25, 232, 141, 98, 9, 182, 154, 156, 133, 126, 217, 63, 151, 210, 247, 207, 122, 82, 146, 208, 14, 13, 7, 64, 151, 39, 18, 30, 9, 251, 45, 162, 106, 72, 148, 92, 194, 138, 19, 25, 246, 47, 26, 131, 235, 30, 45, 111, 8, 92, 67, 204, 126, 153, 117, 150, 164, 112, 11, 32, 243, 252, 44, 145, 9, 175, 25, 229, 136, 167, 242, 4, 5, 166, 35, 166, 215, 127, 240, 22, 0, 150, 192, 230, 255, 100, 187, 194, 120, 182, 67, 3, 20, 174, 198, 115, 249, 224, 139, 3, 112, 7, 215, 64, 172, 193, 103, 156, 24, 90, 66, 50, 107, 244, 142, 124, 6, 49, 222, 176, 148, 93, 108, 93, 59, 179, 186, 168, 146, 82, 188, 87, 131, 168, 188, 120, 97, 192, 87, 30, 44, 244, 198, 66, 11, 13, 70, 113, 254, 146, 67, 64, 115, 105, 193, 230, 21, 209, 114, 223, 92, 171, 240, 227, 132, 107, 75, 128, 205, 155, 226, 89, 107, 186, 214, 116, 236, 232, 3, 157, 233, 39, 84, 7, 54, 234, 206, 138, 220, 106, 213, 136, 89, 40, 225, 68, 126, 78, 99, 15, 227, 20, 41, 11, 167, 230, 23, 20, 233, 45, 224, 223, 237, 252, 153, 63, 107, 143, 185, 113, 146, 74, 100, 58, 80, 64, 118, 4, 235, 239, 146, 203, 137, 141, 174, 198, 219, 1, 0, 160, 197, 48, 206, 67, 49, 222, 120, 151, 59, 66, 201, 189, 253, 250, 210, 104, 237, 3, 152, 107, 234, 73, 25, 199, 31, 146, 169, 180, 118, 107, 244, 246, 141, 89, 179, 17, 194, 102, 202, 42, 234, 9, 135, 79, 205, 147, 154, 32, 125, 224, 140, 223, 60, 178, 17, 209, 254, 0, 56, 115, 60, 158, 121, 145, 255, 151, 206, 55, 203, 223, 13, 18, 62, 116, 89, 187, 152, 236, 60, 89, 155, 109, 149, 214, 103, 189, 31, 66, 57, 195, 156, 154, 111, 217, 1, 78, 11, 150, 97, 132, 72, 81, 74, 157, 79, 131, 149, 42, 144, 106, 235, 84, 89, 254, 124, 30, 104, 99, 253, 253, 221, 214, 104, 240, 93, 185, 91, 126, 173, 137, 93, 252, 1, 39, 212, 72, 46, 205, 134, 104, 239, 104, 93, 252, 75, 125, 88, 14, 226, 43, 150, 197, 75, 33, 37, 167, 21, 86, 94, 58, 20, 166, 190, 42, 21, 83, 114, 159, 116, 48, 4, 48, 71, 241, 214, 173, 60, 63, 19, 240, 134, 153, 201, 203, 201, 47, 73, 192, 198, 172, 233, 59, 255, 117, 59, 247, 168, 0, 6, 147, 28, 130, 2, 214, 121, 150, 102, 9, 11, 111, 178, 230, 90, 105, 251, 101, 93, 112, 175, 94, 81, 253, 48, 40, 52, 169, 252, 215, 160, 96, 247, 223, 93, 26, 215, 226, 25, 54, 47, 52, 93, 194, 62, 82, 189, 165, 13, 197, 122, 206, 63, 144, 98, 21, 216, 64, 88, 96, 125, 124, 215, 78, 79, 184, 165, 42, 105, 226, 172, 19, 132, 34, 238, 224, 198, 34, 128, 210, 211, 22, 21, 175, 70, 94, 99, 45, 153, 198, 111, 62, 65, 116, 236, 241, 16, 178, 204, 239, 82, 8, 117, 202, 90, 38, 104, 144, 41, 118, 29, 13, 231, 188, 35, 72, 31, 85, 77, 212, 155, 147, 136, 106, 1, 215, 6, 227, 115, 168, 99, 23, 207, 15, 53, 187, 184, 125, 61, 52, 20, 231, 237, 97, 77, 47, 22, 61, 116, 235, 146, 13, 132, 165, 254, 135, 255, 16, 173, 155, 184, 85, 149, 102, 131, 184, 139, 217, 180, 59, 232, 190, 5, 204, 44, 65, 111, 165, 52, 119, 84, 50, 206, 178, 168, 41, 147, 203, 56, 215, 254, 104, 158, 96, 13, 218, 184, 173, 74, 116, 236, 14, 134, 73, 45, 121, 24, 1, 38, 74, 246, 153, 222, 126, 99, 229, 187, 8, 164, 158, 20, 179, 140, 136, 208, 241, 64, 14, 156, 129, 165, 0, 224, 150, 95, 49, 59, 111, 29, 9, 155, 93, 125, 243, 116, 119, 31, 170, 219, 135, 127, 27, 65, 42, 156, 127, 184, 93, 172, 144, 69, 88, 69, 195, 80, 213, 154, 141, 83, 220, 223, 199, 120, 104, 41, 215, 153, 146, 196, 43, 213, 68, 102, 143, 106, 191, 217, 188, 7, 203, 151, 153, 232, 221, 182, 72, 174, 156, 231, 63, 11, 78, 230, 63, 22, 230, 242, 146, 104, 217, 243, 110, 18, 251, 27, 30, 122, 49, 120, 101, 41, 174, 225, 71, 27, 20, 201, 172, 79, 5, 5, 108, 168, 98, 9, 14, 99, 8, 134, 186, 12, 3, 218, 90, 39, 222, 2, 181, 145, 164, 66, 226, 197, 212, 167, 143, 41, 139, 42, 172, 25, 231, 190, 162, 195, 107, 19, 165, 203, 37, 48, 91, 7, 18, 141, 186, 250, 75, 73, 30, 156, 9, 111, 201, 156, 197, 198, 128, 70, 228, 176, 88, 75, 115, 101, 17, 80, 67, 114, 149, 251, 29, 244, 58, 59, 221, 227, 167, 182, 59, 225, 183, 33, 58, 166, 33, 8, 35, 151, 153, 150, 175, 152, 92, 100, 203, 91, 216, 55, 196, 234, 85, 179, 224, 146, 53, 146, 220, 214, 190, 216, 160, 135, 171, 73, 21, 17, 174, 142, 147, 3, 119, 208, 85, 222, 9, 49, 39, 244, 216, 157, 106, 106, 184, 90, 228, 48, 1, 117, 158, 2, 148, 176, 72, 203, 140, 159, 128, 156, 220, 83, 193, 100, 154, 186, 196, 1, 42, 169, 173, 65, 125, 132, 135, 104, 165, 47, 1, 221, 141, 184, 247, 31, 120, 171, 62, 248, 30, 103, 37, 62, 123, 99, 255, 41, 74, 236, 141, 2, 213, 204, 182, 125, 137, 66, 235, 115, 248, 46, 152, 176, 92, 231, 165, 244, 209, 212, 250, 197, 229, 164, 202, 48, 244, 229, 76, 163, 221, 248, 209, 249, 203, 183, 168, 101, 38, 33, 187, 147, 85, 34, 127, 53, 134, 203, 120, 245, 229, 23, 230, 141, 49, 131, 56, 122, 2, 216, 198, 86, 119, 47, 95, 102, 42, 231, 250, 148, 87, 176, 25, 218, 208, 150, 29, 200, 61, 39, 110, 224, 5, 19, 221, 79, 251, 230, 137, 238, 98, 53, 68, 229, 208, 42, 79, 31, 250, 103, 1, 252, 205, 0, 135, 184, 82, 143, 105, 118, 86, 47, 27, 45, 38, 108, 82, 86, 170, 8, 157, 168, 125, 65, 235, 31, 59, 22, 236, 108, 211, 126, 2, 142, 172, 62, 93, 149, 59, 77, 16, 175, 29, 121, 69, 108, 124, 231, 97, 53, 76, 102, 37, 44, 130, 23, 99, 233, 151, 191, 229, 137, 238, 171, 32, 177, 48, 188, 97, 177, 153, 203, 169, 126, 52, 216, 180, 217, 39, 180, 232, 73, 227, 164, 157, 238, 55, 54, 83, 93, 175, 120, 40, 83, 173, 238, 220, 176, 75, 249, 207, 199, 111, 190, 121, 165, 85, 86, 188, 40, 31, 213, 159, 21, 242, 91, 255, 209, 161, 225, 68, 157, 117, 122, 143, 110, 48, 60, 135, 85, 214, 10, 60, 32, 19, 62, 91, 81, 169, 49, 147, 115, 32, 153, 9, 140, 28, 50, 175, 128, 245, 168, 17, 56, 12, 182, 125, 86, 72, 163, 240, 120, 34, 45, 253, 182, 218, 251, 218, 98, 68, 73, 137, 151, 83, 161, 80, 57, 124, 85, 152, 76, 72, 164, 212, 6, 155, 99, 242, 229, 190, 131, 70, 47, 172, 8, 157, 79, 150, 217, 68, 153, 39, 187, 223, 254, 113, 219, 242, 199, 37, 48, 209, 192, 18, 146, 208, 108, 244, 35, 91, 184, 145, 133, 238, 180, 0, 46, 205, 170, 29, 23, 85, 89, 72, 203, 184, 112, 24, 68, 69, 129, 104, 254, 189, 179, 183, 215, 193, 218, 98, 20, 205, 102, 240, 20, 138, 26, 41, 178, 98, 11, 147, 115, 66, 102, 253, 109];

const CUSTOM_READ: [u8; 56] = [97, 116, 100, 100, 0, 0, 0, 1, 177, 115, 65, 228, 168, 213, 22, 237, 0, 0, 0, 0, 0, 24, 167, 85, 73, 181, 122, 248, 125, 79, 204, 81, 143, 89, 92, 16, 74, 127, 19, 147, 13, 231, 205, 139, 108, 166, 88, 202, 166, 200, 223, 35, 87, 14, 188, 35];
const CUSTOM_WRITE: [u8; 4152] = [97, 116, 100, 100, 0, 0, 0, 2, 177, 115, 65, 228, 168, 213, 22, 237, 0, 0, 0, 0, 0, 24, 167, 85, 238, 175, 7, 29, 100, 113, 98, 36, 225, 187, 114, 140, 179, 254, 24, 78, 41, 59, 2, 73, 200, 64, 133, 146, 27, 160, 243, 44, 228, 184, 174, 45, 16, 116, 47, 20, 189, 146, 194, 161, 179, 80, 99, 116, 117, 93, 111, 209, 243, 133, 116, 165, 122, 222, 197, 145, 0, 97, 131, 180, 133, 178, 122, 122, 54, 2, 188, 152, 144, 167, 112, 113, 225, 215, 86, 198, 56, 178, 5, 222, 228, 120, 239, 233, 76, 54, 147, 241, 147, 35, 144, 83, 238, 163, 43, 1, 1, 12, 40, 154, 84, 160, 115, 72, 210, 161, 236, 80, 100, 202, 3, 87, 23, 135, 59, 188, 70, 4, 17, 89, 80, 57, 188, 13, 24, 9, 229, 185, 200, 173, 136, 65, 243, 122, 2, 168, 102, 134, 81, 177, 119, 129, 126, 61, 213, 252, 17, 225, 244, 8, 123, 55, 159, 81, 30, 235, 228, 158, 150, 196, 240, 204, 84, 62, 130, 57, 157, 73, 40, 255, 224, 246, 98, 234, 241, 228, 77, 147, 62, 233, 35, 2, 130, 29, 128, 59, 0, 190, 251, 137, 113, 226, 113, 38, 163, 130, 65, 240, 97, 212, 25, 14, 232, 201, 136, 196, 71, 229, 213, 147, 51, 155, 46, 252, 98, 145, 19, 105, 77, 105, 248, 129, 18, 241, 94, 215, 175, 81, 141, 59, 239, 114, 172, 197, 130, 154, 127, 11, 66, 246, 145, 19, 171, 63, 61, 84, 160, 190, 120, 29, 213, 129, 71, 222, 87, 35, 194, 28, 177, 91, 45, 199, 42, 102, 10, 134, 131, 81, 207, 114, 137, 244, 50, 3, 250, 19, 147, 146, 221, 80, 34, 252, 206, 61, 218, 114, 181, 113, 215, 245, 63, 182, 14, 216, 105, 18, 27, 5, 35, 99, 64, 86, 211, 194, 38, 81, 114, 252, 111, 153, 67, 187, 172, 240, 195, 177, 98, 56, 131, 202, 70, 128, 38, 20, 145, 80, 89, 111, 71, 184, 109, 151, 226, 233, 125, 184, 249, 216, 204, 90, 145, 149, 52, 204, 21, 58, 132, 88, 81, 231, 105, 19, 255, 150, 54, 15, 79, 187, 144, 34, 28, 18, 24, 206, 238, 15, 92, 223, 43, 219, 182, 47, 243, 60, 155, 70, 148, 189, 133, 173, 196, 159, 209, 248, 197, 252, 91, 214, 239, 34, 129, 62, 249, 13, 183, 186, 181, 30, 210, 210, 245, 254, 74, 224, 94, 96, 16, 7, 4, 50, 81, 143, 73, 74, 115, 117, 22, 248, 78, 142, 131, 74, 210, 243, 105, 49, 151, 25, 244, 249, 97, 241, 123, 207, 56, 156, 176, 52, 189, 159, 16, 205, 90, 56, 212, 123, 111, 40, 215, 253, 219, 190, 30, 63, 155, 210, 85, 120, 111, 130, 31, 89, 210, 14, 56, 220, 228, 71, 41, 138, 201, 249, 71, 236, 208, 224, 176, 183, 116, 21, 32, 91, 53, 205, 103, 25, 159, 176, 32, 162, 65, 165, 239, 236, 186, 218, 143, 205, 18, 220, 152, 88, 37, 34, 110, 68, 104, 63, 51, 88, 85, 179, 45, 176, 235, 64, 237, 37, 155, 205, 79, 165, 192, 200, 214, 78, 153, 179, 255, 241, 178, 57, 181, 232, 245, 168, 12, 194, 137, 84, 209, 3, 101, 170, 172, 131, 161, 55, 7, 170, 200, 99, 22, 176, 195, 229, 85, 118, 110, 227, 157, 101, 183, 246, 135, 8, 19, 178, 214, 32, 86, 113, 104, 38, 128, 75, 219, 230, 158, 198, 53, 26, 231, 238, 75, 246, 224, 181, 61, 57, 78, 81, 139, 245, 244, 241, 144, 160, 49, 94, 211, 18, 222, 250, 91, 178, 31, 103, 1, 161, 13, 130, 133, 145, 126, 74, 127, 241, 86, 176, 249, 65, 170, 215, 213, 145, 239, 216, 5, 43, 47, 99, 224, 116, 167, 226, 108, 136, 151, 36, 2, 63, 91, 244, 246, 211, 37, 179, 250, 125, 46, 69, 234, 57, 66, 186, 51, 226, 223, 227, 139, 137, 25, 18, 251, 79, 37, 144, 212, 86, 62, 249, 187, 135, 171, 7, 141, 127, 28, 103, 78, 124, 128, 71, 140, 36, 71, 155, 227, 68, 208, 185, 58, 167, 164, 99, 94, 26, 204, 115, 72, 190, 203, 101, 212, 188, 76, 116, 231, 35, 131, 76, 109, 227, 79, 179, 98, 254, 76, 80, 64, 209, 1, 233, 110, 163, 86, 218, 175, 73, 111, 5, 93, 110, 161, 46, 196, 109, 145, 58, 164, 183, 240, 209, 41, 159, 102, 137, 238, 88, 49, 16, 230, 164, 133, 247, 128, 174, 3, 202, 206, 143, 255, 217, 243, 137, 13, 126, 77, 97, 235, 161, 99, 227, 106, 252, 178, 117, 40, 45, 205, 154, 134, 151, 125, 101, 161, 79, 134, 169, 21, 179, 87, 232, 164, 21, 85, 26, 198, 143, 118, 22, 238, 244, 23, 198, 91, 48, 199, 217, 201, 99, 114, 210, 251, 70, 189, 141, 225, 139, 83, 209, 126, 101, 162, 94, 90, 40, 158, 49, 25, 159, 237, 12, 158, 86, 170, 241, 63, 103, 150, 12, 71, 188, 31, 184, 119, 25, 206, 26, 218, 47, 199, 245, 131, 229, 173, 70, 223, 231, 204, 87, 91, 26, 28, 93, 173, 174, 169, 139, 45, 106, 57, 142, 174, 18, 12, 146, 61, 249, 184, 171, 134, 67, 64, 4, 84, 165, 248, 242, 50, 236, 178, 18, 115, 158, 228, 38, 64, 28, 230, 31, 108, 162, 238, 108, 120, 76, 42, 85, 151, 207, 238, 121, 60, 123, 244, 15, 101, 108, 193, 88, 206, 51, 15, 220, 59, 28, 217, 2, 100, 191, 60, 31, 238, 172, 163, 166, 124, 190, 237, 22, 123, 147, 61, 244, 115, 149, 142, 233, 206, 4, 47, 1, 40, 223, 240, 32, 165, 209, 118, 183, 4, 222, 60, 169, 2, 227, 77, 163, 171, 165, 69, 85, 82, 146, 116, 173, 170, 172, 117, 8, 202, 122, 50, 54, 134, 167, 175, 17, 192, 10, 88, 19, 203, 38, 108, 240, 13, 49, 227, 85, 74, 239, 176, 121, 172, 1, 235, 48, 117, 212, 103, 133, 182, 60, 9, 0, 71, 21, 5, 112, 52, 96, 190, 78, 200, 220, 86, 28, 232, 21, 171, 228, 136, 49, 41, 206, 116, 70, 176, 165, 130, 75, 254, 242, 167, 124, 64, 98, 215, 210, 224, 1, 247, 132, 58, 144, 160, 58, 103, 172, 76, 15, 198, 73, 254, 248, 147, 198, 220, 122, 47, 188, 216, 126, 62, 18, 15, 1, 84, 36, 161, 250, 48, 158, 92, 90, 168, 227, 100, 99, 201, 174, 161, 190, 228, 128, 247, 99, 207, 24, 155, 72, 170, 6, 155, 70, 125, 2, 158, 178, 37, 19, 86, 21, 246, 223, 55, 132, 92, 82, 236, 168, 136, 194, 226, 75, 199, 6, 155, 85, 50, 88, 94, 49, 84, 26, 194, 160, 71, 121, 110, 133, 121, 47, 210, 162, 152, 160, 173, 223, 9, 33, 244, 153, 159, 198, 15, 12, 150, 163, 100, 234, 91, 122, 86, 97, 206, 38, 170, 254, 65, 103, 28, 20, 23, 176, 150, 31, 176, 147, 70, 79, 94, 175, 179, 240, 56, 10, 154, 147, 143, 33, 76, 147, 61, 72, 45, 155, 155, 186, 63, 34, 71, 168, 164, 119, 102, 84, 228, 206, 122, 74, 214, 207, 246, 54, 227, 230, 50, 16, 207, 70, 253, 108, 98, 127, 7, 150, 193, 135, 46, 182, 166, 163, 127, 140, 205, 75, 157, 22, 0, 75, 154, 26, 109, 228, 171, 204, 58, 208, 80, 134, 180, 44, 87, 108, 86, 58, 77, 142, 164, 141, 47, 52, 12, 207, 173, 36, 169, 60, 186, 154, 205, 75, 201, 244, 137, 120, 67, 24, 42, 33, 124, 242, 61, 31, 147, 23, 11, 209, 215, 127, 133, 229, 135, 204, 129, 148, 189, 95, 4, 216, 115, 106, 114, 173, 245, 101, 238, 42, 26, 61, 57, 63, 90, 157, 50, 111, 118, 71, 67, 211, 135, 28, 31, 91, 151, 181, 117, 251, 255, 114, 204, 89, 205, 240, 145, 225, 75, 131, 175, 84, 196, 179, 246, 168, 180, 63, 152, 73, 255, 177, 41, 193, 204, 16, 64, 35, 201, 250, 163, 126, 145, 92, 4, 74, 190, 46, 82, 151, 164, 215, 250, 146, 133, 66, 178, 97, 50, 228, 67, 220, 28, 27, 221, 182, 118, 252, 100, 158, 83, 33, 177, 175, 206, 40, 47, 116, 179, 214, 111, 245, 213, 137, 144, 183, 6, 131, 138, 224, 12, 225, 188, 173, 117, 57, 185, 198, 131, 170, 149, 0, 117, 253, 178, 49, 236, 244, 163, 127, 58, 157, 219, 1, 106, 182, 161, 100, 62, 59, 169, 23, 163, 221, 52, 132, 216, 221, 102, 251, 200, 168, 99, 89, 85, 164, 90, 119, 98, 107, 78, 1, 85, 203, 233, 0, 85, 114, 58, 238, 88, 32, 47, 241, 222, 251, 40, 25, 187, 83, 2, 143, 182, 134, 40, 99, 94, 16, 92, 35, 25, 150, 165, 230, 129, 122, 24, 191, 50, 5, 32, 148, 175, 232, 179, 2, 70, 8, 66, 13, 104, 27, 24, 4, 60, 133, 57, 162, 97, 189, 39, 132, 228, 165, 193, 172, 227, 192, 239, 57, 171, 94, 120, 178, 105, 27, 92, 169, 65, 25, 250, 69, 231, 133, 32, 139, 217, 111, 130, 13, 106, 95, 102, 248, 116, 13, 187, 192, 68, 202, 181, 16, 38, 101, 56, 90, 230, 2, 154, 16, 148, 119, 144, 180, 194, 223, 218, 186, 0, 181, 160, 24, 31, 245, 61, 126, 86, 148, 79, 143, 117, 251, 205, 232, 28, 69, 199, 117, 126, 191, 23, 191, 213, 36, 196, 124, 45, 201, 4, 215, 158, 59, 124, 223, 26, 19, 220, 56, 44, 94, 202, 85, 12, 135, 244, 110, 44, 59, 112, 21, 229, 119, 121, 132, 133, 114, 251, 148, 204, 208, 209, 154, 104, 115, 73, 38, 144, 153, 51, 192, 63, 150, 144, 146, 66, 81, 85, 232, 17, 1, 218, 188, 199, 194, 249, 250, 105, 14, 92, 212, 238, 134, 104, 75, 132, 197, 120, 187, 170, 191, 142, 104, 0, 242, 121, 55, 132, 186, 143, 225, 184, 227, 18, 2, 102, 84, 237, 115, 105, 230, 11, 202, 255, 226, 9, 155, 53, 131, 45, 52, 169, 41, 143, 250, 248, 141, 104, 182, 52, 41, 116, 120, 1, 27, 254, 131, 254, 175, 123, 154, 43, 239, 185, 204, 15, 126, 152, 254, 119, 169, 209, 233, 230, 180, 194, 125, 58, 138, 16, 180, 123, 65, 172, 140, 8, 151, 154, 182, 138, 140, 112, 55, 104, 239, 182, 82, 75, 46, 82, 110, 215, 7, 242, 7, 209, 127, 213, 192, 135, 202, 17, 49, 201, 123, 243, 62, 63, 85, 73, 183, 150, 183, 94, 199, 183, 43, 109, 87, 98, 2, 251, 108, 170, 114, 128, 52, 43, 232, 110, 226, 68, 3, 65, 98, 180, 27, 24, 223, 22, 252, 144, 162, 99, 176, 188, 143, 160, 244, 111, 214, 177, 230, 151, 41, 210, 17, 204, 25, 119, 165, 231, 90, 4, 45, 98, 218, 40, 241, 196, 143, 96, 136, 169, 199, 149, 158, 41, 56, 69, 163, 234, 188, 210, 39, 254, 213, 48, 249, 153, 239, 58, 5, 228, 125, 119, 207, 180, 87, 6, 99, 2, 26, 158, 79, 67, 188, 253, 200, 253, 167, 64, 119, 163, 80, 184, 7, 178, 26, 89, 68, 36, 131, 9, 33, 64, 159, 100, 109, 38, 18, 77, 121, 1, 26, 210, 192, 210, 110, 135, 47, 24, 90, 145, 105, 57, 131, 131, 225, 243, 40, 212, 20, 229, 19, 111, 79, 142, 171, 55, 104, 60, 113, 182, 10, 192, 100, 190, 112, 24, 247, 90, 28, 96, 156, 88, 112, 173, 144, 223, 117, 131, 201, 122, 186, 11, 118, 79, 182, 247, 37, 231, 146, 117, 242, 194, 113, 188, 210, 239, 121, 231, 100, 54, 229, 240, 98, 215, 41, 190, 108, 64, 43, 189, 9, 188, 209, 64, 82, 139, 6, 144, 83, 35, 139, 95, 222, 159, 173, 3, 1, 31, 130, 255, 75, 162, 125, 4, 62, 82, 1, 78, 51, 142, 193, 249, 110, 171, 159, 154, 20, 230, 167, 127, 106, 94, 7, 192, 0, 250, 11, 150, 47, 104, 165, 215, 100, 98, 171, 16, 145, 29, 91, 228, 203, 4, 41, 211, 127, 12, 229, 195, 118, 55, 121, 17, 42, 173, 63, 16, 155, 128, 37, 244, 235, 190, 140, 127, 204, 4, 124, 13, 252, 52, 146, 231, 8, 91, 251, 72, 79, 116, 7, 167, 152, 221, 133, 137, 127, 151, 28, 253, 93, 252, 253, 49, 13, 27, 111, 174, 235, 69, 148, 93, 200, 46, 228, 228, 95, 207, 200, 109, 166, 138, 254, 199, 127, 155, 142, 225, 28, 49, 107, 222, 126, 140, 75, 129, 86, 53, 42, 148, 75, 150, 109, 138, 28, 198, 142, 111, 160, 181, 204, 119, 77, 121, 150, 4, 54, 50, 153, 144, 182, 208, 124, 223, 140, 97, 29, 241, 230, 150, 144, 75, 74, 75, 247, 249, 13, 234, 191, 54, 180, 38, 66, 40, 213, 109, 17, 36, 223, 86, 45, 57, 115, 12, 143, 68, 160, 152, 199, 237, 18, 67, 167, 162, 251, 121, 69, 34, 46, 34, 28, 60, 35, 65, 209, 86, 136, 88, 188, 115, 9, 228, 202, 69, 59, 153, 70, 101, 185, 204, 119, 13, 142, 213, 246, 39, 4, 194, 167, 185, 198, 165, 222, 8, 83, 185, 213, 35, 234, 182, 113, 118, 177, 147, 249, 244, 52, 230, 235, 53, 173, 121, 123, 148, 67, 242, 187, 178, 144, 59, 196, 8, 199, 159, 41, 89, 72, 64, 115, 124, 83, 3, 245, 176, 199, 50, 37, 226, 132, 188, 81, 245, 178, 86, 178, 164, 120, 2, 113, 130, 208, 142, 70, 82, 159, 180, 172, 35, 111, 178, 202, 241, 177, 230, 125, 116, 154, 81, 250, 217, 27, 202, 210, 18, 56, 97, 198, 108, 161, 227, 70, 212, 43, 87, 10, 149, 244, 105, 27, 66, 79, 236, 64, 231, 119, 24, 34, 174, 151, 50, 33, 98, 173, 76, 198, 241, 54, 24, 176, 72, 165, 159, 230, 58, 209, 178, 62, 145, 201, 57, 190, 221, 150, 214, 193, 155, 85, 194, 61, 178, 223, 143, 173, 185, 63, 187, 193, 190, 21, 36, 231, 89, 92, 69, 0, 106, 139, 255, 109, 33, 45, 139, 92, 1, 212, 123, 126, 190, 218, 238, 247, 109, 68, 28, 161, 179, 239, 236, 253, 63, 23, 34, 48, 11, 15, 51, 28, 108, 190, 215, 30, 206, 12, 185, 62, 40, 114, 43, 198, 229, 110, 65, 23, 152, 9, 181, 118, 16, 188, 153, 132, 242, 95, 7, 106, 95, 65, 123, 107, 36, 34, 250, 92, 114, 108, 72, 98, 179, 62, 137, 125, 162, 18, 178, 22, 140, 57, 91, 170, 20, 143, 118, 24, 146, 168, 212, 51, 234, 94, 65, 248, 233, 120, 245, 163, 19, 162, 215, 101, 219, 39, 113, 110, 46, 150, 53, 243, 139, 11, 91, 44, 83, 106, 213, 125, 221, 98, 19, 5, 187, 14, 70, 62, 190, 60, 240, 151, 97, 228, 186, 0, 90, 91, 243, 140, 246, 249, 188, 233, 90, 118, 14, 254, 216, 144, 102, 9, 115, 214, 3, 17, 199, 138, 62, 131, 88, 238, 22, 169, 104, 149, 76, 150, 95, 233, 203, 71, 248, 115, 210, 27, 39, 165, 159, 200, 9, 71, 6, 239, 31, 210, 14, 200, 141, 163, 169, 54, 30, 137, 203, 227, 215, 61, 206, 242, 174, 86, 202, 65, 159, 7, 182, 245, 115, 8, 53, 33, 1, 62, 67, 126, 45, 126, 71, 239, 216, 147, 182, 111, 65, 255, 152, 238, 102, 196, 117, 19, 72, 183, 235, 41, 157, 105, 129, 118, 148, 85, 68, 234, 93, 226, 17, 176, 14, 178, 62, 135, 128, 145, 164, 50, 73, 47, 109, 101, 110, 155, 180, 139, 25, 57, 90, 144, 66, 60, 6, 190, 71, 251, 137, 45, 76, 24, 201, 169, 252, 0, 84, 233, 153, 21, 115, 89, 32, 125, 164, 85, 237, 76, 84, 69, 152, 125, 253, 231, 203, 81, 171, 116, 115, 102, 102, 66, 83, 205, 42, 188, 219, 141, 74, 109, 214, 166, 29, 165, 77, 159, 202, 213, 165, 172, 58, 97, 94, 55, 98, 21, 72, 130, 150, 165, 212, 42, 151, 255, 67, 34, 236, 87, 113, 221, 8, 245, 204, 94, 238, 192, 0, 136, 74, 123, 178, 15, 2, 214, 106, 160, 144, 214, 153, 76, 196, 125, 223, 173, 104, 90, 9, 239, 131, 25, 232, 141, 98, 9, 182, 154, 156, 133, 126, 217, 63, 151, 210, 247, 207, 122, 82, 146, 208, 14, 13, 7, 64, 151, 39, 18, 30, 9, 251, 45, 162, 106, 72, 148, 92, 194, 138, 19, 25, 246, 47, 26, 131, 235, 30, 45, 111, 8, 92, 67, 204, 126, 153, 117, 150, 164, 112, 11, 32, 243, 252, 44, 145, 9, 175, 25, 229, 136, 167, 242, 4, 5, 166, 35, 166, 215, 127, 240, 22, 0, 150, 192, 230, 255, 100, 187, 194, 120, 182, 67, 3, 20, 174, 198, 115, 249, 224, 139, 3, 112, 7, 215, 64, 172, 193, 103, 156, 24, 90, 66, 50, 107, 244, 142, 124, 6, 49, 222, 176, 148, 93, 108, 93, 59, 179, 186, 168, 146, 82, 188, 87, 131, 168, 188, 120, 97, 192, 87, 30, 44, 244, 198, 66, 11, 13, 70, 113, 254, 146, 67, 64, 115, 105, 193, 230, 21, 209, 114, 223, 92, 171, 240, 227, 132, 107, 75, 128, 205, 155, 226, 89, 107, 186, 214, 116, 236, 232, 3, 157, 233, 39, 84, 7, 54, 234, 206, 138, 220, 106, 213, 136, 89, 40, 225, 68, 126, 78, 99, 15, 227, 20, 41, 11, 167, 230, 23, 20, 233, 45, 224, 223, 237, 252, 153, 63, 107, 143, 185, 113, 146, 74, 100, 58, 80, 64, 118, 4, 235, 239, 146, 203, 137, 141, 174, 198, 219, 1, 0, 160, 197, 48, 206, 67, 49, 222, 120, 151, 59, 66, 201, 189, 253, 250, 210, 104, 237, 3, 152, 107, 234, 73, 25, 199, 31, 146, 169, 180, 118, 107, 244, 246, 141, 89, 179, 17, 194, 102, 202, 42, 234, 9, 135, 79, 205, 147, 154, 32, 125, 224, 140, 223, 60, 178, 17, 209, 254, 0, 56, 115, 60, 158, 121, 145, 255, 151, 206, 55, 203, 223, 13, 18, 62, 116, 89, 187, 152, 236, 60, 89, 155, 109, 149, 214, 103, 189, 31, 66, 57, 195, 156, 154, 111, 217, 1, 78, 11, 150, 97, 132, 72, 81, 74, 157, 79, 131, 149, 42, 144, 106, 235, 84, 89, 254, 124, 30, 104, 99, 253, 253, 221, 214, 104, 240, 93, 185, 91, 126, 173, 137, 93, 252, 1, 39, 212, 72, 46, 205, 134, 104, 239, 104, 93, 252, 75, 125, 88, 14, 226, 43, 150, 197, 75, 33, 37, 167, 21, 86, 94, 58, 20, 166, 190, 42, 21, 83, 114, 159, 116, 48, 4, 48, 71, 241, 214, 173, 60, 63, 19, 240, 134, 153, 201, 203, 201, 47, 73, 192, 198, 172, 233, 59, 255, 117, 59, 247, 168, 0, 6, 147, 28, 130, 2, 214, 121, 150, 102, 9, 11, 111, 178, 230, 90, 105, 251, 101, 93, 112, 175, 94, 81, 253, 48, 40, 52, 169, 252, 215, 160, 96, 247, 223, 93, 26, 215, 226, 25, 54, 47, 52, 93, 194, 62, 82, 189, 165, 13, 197, 122, 206, 63, 144, 98, 21, 216, 64, 88, 96, 125, 124, 215, 78, 79, 184, 165, 42, 105, 226, 172, 19, 132, 34, 238, 224, 198, 34, 128, 210, 211, 22, 21, 175, 70, 94, 99, 45, 153, 198, 111, 62, 65, 116, 236, 241, 16, 178, 204, 239, 82, 8, 117, 202, 90, 38, 104, 144, 41, 118, 29, 13, 231, 188, 35, 72, 31, 85, 77, 212, 155, 147, 136, 106, 1, 215, 6, 227, 115, 168, 99, 23, 207, 15, 53, 187, 184, 125, 61, 52, 20, 231, 237, 97, 77, 47, 22, 61, 116, 235, 146, 13, 132, 165, 254, 135, 255, 16, 173, 155, 184, 85, 149, 102, 131, 184, 139, 217, 180, 59, 232, 190, 5, 204, 44, 65, 111, 165, 52, 119, 84, 50, 206, 178, 168, 41, 147, 203, 56, 215, 254, 104, 158, 96, 13, 218, 184, 173, 74, 116, 236, 14, 134, 73, 45, 121, 24, 1, 38, 74, 246, 153, 222, 126, 99, 229, 187, 8, 164, 158, 20, 179, 140, 136, 208, 241, 64, 14, 156, 129, 165, 0, 224, 150, 95, 49, 59, 111, 29, 9, 155, 93, 125, 243, 116, 119, 31, 170, 219, 135, 127, 27, 65, 42, 156, 127, 184, 93, 172, 144, 69, 88, 69, 195, 80, 213, 154, 141, 83, 220, 223, 199, 120, 104, 41, 215, 153, 146, 196, 43, 213, 68, 102, 143, 106, 191, 217, 188, 7, 203, 151, 153, 232, 221, 182, 72, 174, 156, 231, 63, 11, 78, 230, 63, 22, 230, 242, 146, 104, 217, 243, 110, 18, 251, 27, 30, 122, 49, 120, 101, 41, 174, 225, 71, 27, 20, 201, 172, 79, 5, 5, 108, 168, 98, 9, 14, 99, 8, 134, 186, 12, 3, 218, 90, 39, 222, 2, 181, 145, 164, 66, 226, 197, 212, 167, 143, 41, 139, 42, 172, 25, 231, 190, 162, 195, 107, 19, 165, 203, 37, 48, 91, 7, 18, 141, 186, 250, 75, 73, 30, 156, 9, 111, 201, 156, 197, 198, 128, 70, 228, 176, 88, 75, 115, 101, 17, 80, 67, 114, 149, 251, 29, 244, 58, 59, 221, 227, 167, 182, 59, 225, 183, 33, 58, 166, 33, 8, 35, 151, 153, 150, 175, 152, 92, 100, 203, 91, 216, 55, 196, 234, 85, 179, 224, 146, 53, 146, 220, 214, 190, 216, 160, 135, 171, 73, 21, 17, 174, 142, 147, 3, 119, 208, 85, 222, 9, 49, 39, 244, 216, 157, 106, 106, 184, 90, 228, 48, 1, 117, 158, 2, 148, 176, 72, 203, 140, 159, 128, 156, 220, 83, 193, 100, 154, 186, 196, 1, 42, 169, 173, 65, 125, 132, 135, 104, 165, 47, 1, 221, 141, 184, 247, 31, 120, 171, 62, 248, 30, 103, 37, 62, 123, 99, 255, 41, 74, 236, 141, 2, 213, 204, 182, 125, 137, 66, 235, 115, 248, 46, 152, 176, 92, 231, 165, 244, 209, 212, 250, 197, 229, 164, 202, 48, 244, 229, 76, 163, 221, 248, 209, 249, 203, 183, 168, 101, 38, 33, 187, 147, 85, 34, 127, 53, 134, 203, 120, 245, 229, 23, 230, 141, 49, 131, 56, 122, 2, 216, 198, 86, 119, 47, 95, 102, 42, 231, 250, 148, 87, 176, 25, 218, 208, 150, 29, 200, 61, 39, 110, 224, 5, 19, 221, 79, 251, 230, 137, 238, 98, 53, 68, 229, 208, 42, 79, 31, 250, 103, 1, 252, 205, 0, 135, 184, 82, 143, 105, 118, 86, 47, 27, 45, 38, 108, 82, 86, 170, 8, 157, 168, 125, 65, 235, 31, 59, 22, 236, 108, 211, 126, 2, 142, 172, 62, 93, 149, 59, 77, 16, 175, 29, 121, 69, 108, 124, 231, 97, 53, 76, 102, 37, 44, 130, 23, 99, 233, 151, 191, 229, 137, 238, 171, 32, 177, 48, 188, 97, 177, 153, 203, 169, 126, 52, 216, 180, 217, 39, 180, 232, 73, 227, 164, 157, 238, 55, 54, 83, 93, 175, 120, 40, 83, 173, 238, 220, 176, 75, 249, 207, 199, 111, 190, 121, 165, 85, 86, 188, 40, 31, 213, 159, 21, 242, 91, 255, 209, 161, 225, 68, 157, 117, 122, 143, 110, 48, 60, 135, 85, 214, 10, 60, 32, 19, 62, 91, 81, 169, 49, 147, 115, 32, 153, 9, 140, 28, 50, 175, 128, 245, 168, 17, 56, 12, 182, 125, 86, 72, 163, 240, 120, 34, 45, 253, 182, 218, 251, 218, 98, 68, 73, 137, 151, 83, 161, 80, 57, 124, 85, 152, 76, 72, 164, 212, 6, 155, 99, 242, 229, 190, 131, 70, 47, 172, 8, 157, 79, 150, 217, 68, 153, 39, 187, 223, 254, 113, 219, 242, 199, 37, 48, 209, 192, 18, 146, 208, 108, 244, 35, 91, 184, 145, 133, 238, 180, 0, 46, 205, 170, 29, 23, 85, 89, 72, 203, 184, 112, 24, 68, 69, 129, 104, 254, 189, 179, 183, 215, 193, 218, 98, 20, 205, 102, 240, 20, 138, 26, 41, 178, 98, 11, 147, 115, 66, 102, 253, 109, 192, 101, 158, 39, 157, 109, 241, 121, 179, 253, 73, 113, 188, 20, 196, 136, 35, 59, 136, 108, 103, 167, 30, 168, 43, 203, 91, 128, 8, 225, 16, 155];
const CUSTOM_READ_PROC: [u8; 64] = [97, 116, 100, 100, 0, 0, 205, 3, 250, 105, 14, 18, 145, 80, 69, 90, 165, 16, 247, 215, 234, 71, 105, 162, 0, 0, 0, 0, 0, 24, 167, 85, 193, 199, 176, 136, 130, 157, 172, 228, 16, 143, 91, 215, 41, 210, 238, 186, 110, 15, 46, 241, 15, 139, 222, 1, 232, 13, 40, 158, 125, 227, 51, 18];
const CUSTOM_VALUE: [u8; 4176] = [97, 116, 100, 100, 0, 0, 205, 4, 250, 105, 14, 18, 145, 80, 69, 90, 165, 16, 247, 215, 234, 71, 105, 162, 0, 0, 0, 0, 0, 24, 167, 85, 177, 115, 65, 228, 168, 213, 22, 237, 0, 0, 0, 0, 0, 0, 0, 215, 238, 175, 7, 29, 100, 113, 98, 36, 225, 187, 114, 140, 179, 254, 24, 78, 41, 59, 2, 73, 200, 64, 133, 146, 27, 160, 243, 44, 228, 184, 174, 45, 16, 116, 47, 20, 189, 146, 194, 161, 179, 80, 99, 116, 117, 93, 111, 209, 243, 133, 116, 165, 122, 222, 197, 145, 0, 97, 131, 180, 133, 178, 122, 122, 54, 2, 188, 152, 144, 167, 112, 113, 225, 215, 86, 198, 56, 178, 5, 222, 228, 120, 239, 233, 76, 54, 147, 241, 147, 35, 144, 83, 238, 163, 43, 1, 1, 12, 40, 154, 84, 160, 115, 72, 210, 161, 236, 80, 100, 202, 3, 87, 23, 135, 59, 188, 70, 4, 17, 89, 80, 57, 188, 13, 24, 9, 229, 185, 200, 173, 136, 65, 243, 122, 2, 168, 102, 134, 81, 177, 119, 129, 126, 61, 213, 252, 17, 225, 244, 8, 123, 55, 159, 81, 30, 235, 228, 158, 150, 196, 240, 204, 84, 62, 130, 57, 157, 73, 40, 255, 224, 246, 98, 234, 241, 228, 77, 147, 62, 233, 35, 2, 130, 29, 128, 59, 0, 190, 251, 137, 113, 226, 113, 38, 163, 130, 65, 240, 97, 212, 25, 14, 232, 201, 136, 196, 71, 229, 213, 147, 51, 155, 46, 252, 98, 145, 19, 105, 77, 105, 248, 129, 18, 241, 94, 215, 175, 81, 141, 59, 239, 114, 172, 197, 130, 154, 127, 11, 66, 246, 145, 19, 171, 63, 61, 84, 160, 190, 120, 29, 213, 129, 71, 222, 87, 35, 194, 28, 177, 91, 45, 199, 42, 102, 10, 134, 131, 81, 207, 114, 137, 244, 50, 3, 250, 19, 147, 146, 221, 80, 34, 252, 206, 61, 218, 114, 181, 113, 215, 245, 63, 182, 14, 216, 105, 18, 27, 5, 35, 99, 64, 86, 211, 194, 38, 81, 114, 252, 111, 153, 67, 187, 172, 240, 195, 177, 98, 56, 131, 202, 70, 128, 38, 20, 145, 80, 89, 111, 71, 184, 109, 151, 226, 233, 125, 184, 249, 216, 204, 90, 145, 149, 52, 204, 21, 58, 132, 88, 81, 231, 105, 19, 255, 150, 54, 15, 79, 187, 144, 34, 28, 18, 24, 206, 238, 15, 92, 223, 43, 219, 182, 47, 243, 60, 155, 70, 148, 189, 133, 173, 196, 159, 209, 248, 197, 252, 91, 214, 239, 34, 129, 62, 249, 13, 183, 186, 181, 30, 210, 210, 245, 254, 74, 224, 94, 96, 16, 7, 4, 50, 81, 143, 73, 74, 115, 117, 22, 248, 78, 142, 131, 74, 210, 243, 105, 49, 151, 25, 244, 249, 97, 241, 123, 207, 56, 156, 176, 52, 189, 159, 16, 205, 90, 56, 212, 123, 111, 40, 215, 253, 219, 190, 30, 63, 155, 210, 85, 120, 111, 130, 31, 89, 210, 14, 56, 220, 228, 71, 41, 138, 201, 249, 71, 236, 208, 224, 176, 183, 116, 21, 32, 91, 53, 205, 103, 25, 159, 176, 32, 162, 65, 165, 239, 236, 186, 218, 143, 205, 18, 220, 152, 88, 37, 34, 110, 68, 104, 63, 51, 88, 85, 179, 45, 176, 235, 64, 237, 37, 155, 205, 79, 165, 192, 200, 214, 78, 153, 179, 255, 241, 178, 57, 181, 232, 245, 168, 12, 194, 137, 84, 209, 3, 101, 170, 172, 131, 161, 55, 7, 170, 200, 99, 22, 176, 195, 229, 85, 118, 110, 227, 157, 101, 183, 246, 135, 8, 19, 178, 214, 32, 86, 113, 104, 38, 128, 75, 219, 230, 158, 198, 53, 26, 231, 238, 75, 246, 224, 181, 61, 57, 78, 81, 139, 245, 244, 241, 144, 160, 49, 94, 211, 18, 222, 250, 91, 178, 31, 103, 1, 161, 13, 130, 133, 145, 126, 74, 127, 241, 86, 176, 249, 65, 170, 215, 213, 145, 239, 216, 5, 43, 47, 99, 224, 116, 167, 226, 108, 136, 151, 36, 2, 63, 91, 244, 246, 211, 37, 179, 250, 125, 46, 69, 234, 57, 66, 186, 51, 226, 223, 227, 139, 137, 25, 18, 251, 79, 37, 144, 212, 86, 62, 249, 187, 135, 171, 7, 141, 127, 28, 103, 78, 124, 128, 71, 140, 36, 71, 155, 227, 68, 208, 185, 58, 167, 164, 99, 94, 26, 204, 115, 72, 190, 203, 101, 212, 188, 76, 116, 231, 35, 131, 76, 109, 227, 79, 179, 98, 254, 76, 80, 64, 209, 1, 233, 110, 163, 86, 218, 175, 73, 111, 5, 93, 110, 161, 46, 196, 109, 145, 58, 164, 183, 240, 209, 41, 159, 102, 137, 238, 88, 49, 16, 230, 164, 133, 247, 128, 174, 3, 202, 206, 143, 255, 217, 243, 137, 13, 126, 77, 97, 235, 161, 99, 227, 106, 252, 178, 117, 40, 45, 205, 154, 134, 151, 125, 101, 161, 79, 134, 169, 21, 179, 87, 232, 164, 21, 85, 26, 198, 143, 118, 22, 238, 244, 23, 198, 91, 48, 199, 217, 201, 99, 114, 210, 251, 70, 189, 141, 225, 139, 83, 209, 126, 101, 162, 94, 90, 40, 158, 49, 25, 159, 237, 12, 158, 86, 170, 241, 63, 103, 150, 12, 71, 188, 31, 184, 119, 25, 206, 26, 218, 47, 199, 245, 131, 229, 173, 70, 223, 231, 204, 87, 91, 26, 28, 93, 173, 174, 169, 139, 45, 106, 57, 142, 174, 18, 12, 146, 61, 249, 184, 171, 134, 67, 64, 4, 84, 165, 248, 242, 50, 236, 178, 18, 115, 158, 228, 38, 64, 28, 230, 31, 108, 162, 238, 108, 120, 76, 42, 85, 151, 207, 238, 121, 60, 123, 244, 15, 101, 108, 193, 88, 206, 51, 15, 220, 59, 28, 217, 2, 100, 191, 60, 31, 238, 172, 163, 166, 124, 190, 237, 22, 123, 147, 61, 244, 115, 149, 142, 233, 206, 4, 47, 1, 40, 223, 240, 32, 165, 209, 118, 183, 4, 222, 60, 169, 2, 227, 77, 163, 171, 165, 69, 85, 82, 146, 116, 173, 170, 172, 117, 8, 202, 122, 50, 54, 134, 167, 175, 17, 192, 10, 88, 19, 203, 38, 108, 240, 13, 49, 227, 85, 74, 239, 176, 121, 172, 1, 235, 48, 117, 212, 103, 133, 182, 60, 9, 0, 71, 21, 5, 112, 52, 96, 190, 78, 200, 220, 86, 28, 232, 21, 171, 228, 136, 49, 41, 206, 116, 70, 176, 165, 130, 75, 254, 242, 167, 124, 64, 98, 215, 210, 224, 1, 247, 132, 58, 144, 160, 58, 103, 172, 76, 15, 198, 73, 254, 248, 147, 198, 220, 122, 47, 188, 216, 126, 62, 18, 15, 1, 84, 36, 161, 250, 48, 158, 92, 90, 168, 227, 100, 99, 201, 174, 161, 190, 228, 128, 247, 99, 207, 24, 155, 72, 170, 6, 155, 70, 125, 2, 158, 178, 37, 19, 86, 21, 246, 223, 55, 132, 92, 82, 236, 168, 136, 194, 226, 75, 199, 6, 155, 85, 50, 88, 94, 49, 84, 26, 194, 160, 71, 121, 110, 133, 121, 47, 210, 162, 152, 160, 173, 223, 9, 33, 244, 153, 159, 198, 15, 12, 150, 163, 100, 234, 91, 122, 86, 97, 206, 38, 170, 254, 65, 103, 28, 20, 23, 176, 150, 31, 176, 147, 70, 79, 94, 175, 179, 240, 56, 10, 154, 147, 143, 33, 76, 147, 61, 72, 45, 155, 155, 186, 63, 34, 71, 168, 164, 119, 102, 84, 228, 206, 122, 74, 214, 207, 246, 54, 227, 230, 50, 16, 207, 70, 253, 108, 98, 127, 7, 150, 193, 135, 46, 182, 166, 163, 127, 140, 205, 75, 157, 22, 0, 75, 154, 26, 109, 228, 171, 204, 58, 208, 80, 134, 180, 44, 87, 108, 86, 58, 77, 142, 164, 141, 47, 52, 12, 207, 173, 36, 169, 60, 186, 154, 205, 75, 201, 244, 137, 120, 67, 24, 42, 33, 124, 242, 61, 31, 147, 23, 11, 209, 215, 127, 133, 229, 135, 204, 129, 148, 189, 95, 4, 216, 115, 106, 114, 173, 245, 101, 238, 42, 26, 61, 57, 63, 90, 157, 50, 111, 118, 71, 67, 211, 135, 28, 31, 91, 151, 181, 117, 251, 255, 114, 204, 89, 205, 240, 145, 225, 75, 131, 175, 84, 196, 179, 246, 168, 180, 63, 152, 73, 255, 177, 41, 193, 204, 16, 64, 35, 201, 250, 163, 126, 145, 92, 4, 74, 190, 46, 82, 151, 164, 215, 250, 146, 133, 66, 178, 97, 50, 228, 67, 220, 28, 27, 221, 182, 118, 252, 100, 158, 83, 33, 177, 175, 206, 40, 47, 116, 179, 214, 111, 245, 213, 137, 144, 183, 6, 131, 138, 224, 12, 225, 188, 173, 117, 57, 185, 198, 131, 170, 149, 0, 117, 253, 178, 49, 236, 244, 163, 127, 58, 157, 219, 1, 106, 182, 161, 100, 62, 59, 169, 23, 163, 221, 52, 132, 216, 221, 102, 251, 200, 168, 99, 89, 85, 164, 90, 119, 98, 107, 78, 1, 85, 203, 233, 0, 85, 114, 58, 238, 88, 32, 47, 241, 222, 251, 40, 25, 187, 83, 2, 143, 182, 134, 40, 99, 94, 16, 92, 35, 25, 150, 165, 230, 129, 122, 24, 191, 50, 5, 32, 148, 175, 232, 179, 2, 70, 8, 66, 13, 104, 27, 24, 4, 60, 133, 57, 162, 97, 189, 39, 132, 228, 165, 193, 172, 227, 192, 239, 57, 171, 94, 120, 178, 105, 27, 92, 169, 65, 25, 250, 69, 231, 133, 32, 139, 217, 111, 130, 13, 106, 95, 102, 248, 116, 13, 187, 192, 68, 202, 181, 16, 38, 101, 56, 90, 230, 2, 154, 16, 148, 119, 144, 180, 194, 223, 218, 186, 0, 181, 160, 24, 31, 245, 61, 126, 86, 148, 79, 143, 117, 251, 205, 232, 28, 69, 199, 117, 126, 191, 23, 191, 213, 36, 196, 124, 45, 201, 4, 215, 158, 59, 124, 223, 26, 19, 220, 56, 44, 94, 202, 85, 12, 135, 244, 110, 44, 59, 112, 21, 229, 119, 121, 132, 133, 114, 251, 148, 204, 208, 209, 154, 104, 115, 73, 38, 144, 153, 51, 192, 63, 150, 144, 146, 66, 81, 85, 232, 17, 1, 218, 188, 199, 194, 249, 250, 105, 14, 92, 212, 238, 134, 104, 75, 132, 197, 120, 187, 170, 191, 142, 104, 0, 242, 121, 55, 132, 186, 143, 225, 184, 227, 18, 2, 102, 84, 237, 115, 105, 230, 11, 202, 255, 226, 9, 155, 53, 131, 45, 52, 169, 41, 143, 250, 248, 141, 104, 182, 52, 41, 116, 120, 1, 27, 254, 131, 254, 175, 123, 154, 43, 239, 185, 204, 15, 126, 152, 254, 119, 169, 209, 233, 230, 180, 194, 125, 58, 138, 16, 180, 123, 65, 172, 140, 8, 151, 154, 182, 138, 140, 112, 55, 104, 239, 182, 82, 75, 46, 82, 110, 215, 7, 242, 7, 209, 127, 213, 192, 135, 202, 17, 49, 201, 123, 243, 62, 63, 85, 73, 183, 150, 183, 94, 199, 183, 43, 109, 87, 98, 2, 251, 108, 170, 114, 128, 52, 43, 232, 110, 226, 68, 3, 65, 98, 180, 27, 24, 223, 22, 252, 144, 162, 99, 176, 188, 143, 160, 244, 111, 214, 177, 230, 151, 41, 210, 17, 204, 25, 119, 165, 231, 90, 4, 45, 98, 218, 40, 241, 196, 143, 96, 136, 169, 199, 149, 158, 41, 56, 69, 163, 234, 188, 210, 39, 254, 213, 48, 249, 153, 239, 58, 5, 228, 125, 119, 207, 180, 87, 6, 99, 2, 26, 158, 79, 67, 188, 253, 200, 253, 167, 64, 119, 163, 80, 184, 7, 178, 26, 89, 68, 36, 131, 9, 33, 64, 159, 100, 109, 38, 18, 77, 121, 1, 26, 210, 192, 210, 110, 135, 47, 24, 90, 145, 105, 57, 131, 131, 225, 243, 40, 212, 20, 229, 19, 111, 79, 142, 171, 55, 104, 60, 113, 182, 10, 192, 100, 190, 112, 24, 247, 90, 28, 96, 156, 88, 112, 173, 144, 223, 117, 131, 201, 122, 186, 11, 118, 79, 182, 247, 37, 231, 146, 117, 242, 194, 113, 188, 210, 239, 121, 231, 100, 54, 229, 240, 98, 215, 41, 190, 108, 64, 43, 189, 9, 188, 209, 64, 82, 139, 6, 144, 83, 35, 139, 95, 222, 159, 173, 3, 1, 31, 130, 255, 75, 162, 125, 4, 62, 82, 1, 78, 51, 142, 193, 249, 110, 171, 159, 154, 20, 230, 167, 127, 106, 94, 7, 192, 0, 250, 11, 150, 47, 104, 165, 215, 100, 98, 171, 16, 145, 29, 91, 228, 203, 4, 41, 211, 127, 12, 229, 195, 118, 55, 121, 17, 42, 173, 63, 16, 155, 128, 37, 244, 235, 190, 140, 127, 204, 4, 124, 13, 252, 52, 146, 231, 8, 91, 251, 72, 79, 116, 7, 167, 152, 221, 133, 137, 127, 151, 28, 253, 93, 252, 253, 49, 13, 27, 111, 174, 235, 69, 148, 93, 200, 46, 228, 228, 95, 207, 200, 109, 166, 138, 254, 199, 127, 155, 142, 225, 28, 49, 107, 222, 126, 140, 75, 129, 86, 53, 42, 148, 75, 150, 109, 138, 28, 198, 142, 111, 160, 181, 204, 119, 77, 121, 150, 4, 54, 50, 153, 144, 182, 208, 124, 223, 140, 97, 29, 241, 230, 150, 144, 75, 74, 75, 247, 249, 13, 234, 191, 54, 180, 38, 66, 40, 213, 109, 17, 36, 223, 86, 45, 57, 115, 12, 143, 68, 160, 152, 199, 237, 18, 67, 167, 162, 251, 121, 69, 34, 46, 34, 28, 60, 35, 65, 209, 86, 136, 88, 188, 115, 9, 228, 202, 69, 59, 153, 70, 101, 185, 204, 119, 13, 142, 213, 246, 39, 4, 194, 167, 185, 198, 165, 222, 8, 83, 185, 213, 35, 234, 182, 113, 118, 177, 147, 249, 244, 52, 230, 235, 53, 173, 121, 123, 148, 67, 242, 187, 178, 144, 59, 196, 8, 199, 159, 41, 89, 72, 64, 115, 124, 83, 3, 245, 176, 199, 50, 37, 226, 132, 188, 81, 245, 178, 86, 178, 164, 120, 2, 113, 130, 208, 142, 70, 82, 159, 180, 172, 35, 111, 178, 202, 241, 177, 230, 125, 116, 154, 81, 250, 217, 27, 202, 210, 18, 56, 97, 198, 108, 161, 227, 70, 212, 43, 87, 10, 149, 244, 105, 27, 66, 79, 236, 64, 231, 119, 24, 34, 174, 151, 50, 33, 98, 173, 76, 198, 241, 54, 24, 176, 72, 165, 159, 230, 58, 209, 178, 62, 145, 201, 57, 190, 221, 150, 214, 193, 155, 85, 194, 61, 178, 223, 143, 173, 185, 63, 187, 193, 190, 21, 36, 231, 89, 92, 69, 0, 106, 139, 255, 109, 33, 45, 139, 92, 1, 212, 123, 126, 190, 218, 238, 247, 109, 68, 28, 161, 179, 239, 236, 253, 63, 23, 34, 48, 11, 15, 51, 28, 108, 190, 215, 30, 206, 12, 185, 62, 40, 114, 43, 198, 229, 110, 65, 23, 152, 9, 181, 118, 16, 188, 153, 132, 242, 95, 7, 106, 95, 65, 123, 107, 36, 34, 250, 92, 114, 108, 72, 98, 179, 62, 137, 125, 162, 18, 178, 22, 140, 57, 91, 170, 20, 143, 118, 24, 146, 168, 212, 51, 234, 94, 65, 248, 233, 120, 245, 163, 19, 162, 215, 101, 219, 39, 113, 110, 46, 150, 53, 243, 139, 11, 91, 44, 83, 106, 213, 125, 221, 98, 19, 5, 187, 14, 70, 62, 190, 60, 240, 151, 97, 228, 186, 0, 90, 91, 243, 140, 246, 249, 188, 233, 90, 118, 14, 254, 216, 144, 102, 9, 115, 214, 3, 17, 199, 138, 62, 131, 88, 238, 22, 169, 104, 149, 76, 150, 95, 233, 203, 71, 248, 115, 210, 27, 39, 165, 159, 200, 9, 71, 6, 239, 31, 210, 14, 200, 141, 163, 169, 54, 30, 137, 203, 227, 215, 61, 206, 242, 174, 86, 202, 65, 159, 7, 182, 245, 115, 8, 53, 33, 1, 62, 67, 126, 45, 126, 71, 239, 216, 147, 182, 111, 65, 255, 152, 238, 102, 196, 117, 19, 72, 183, 235, 41, 157, 105, 129, 118, 148, 85, 68, 234, 93, 226, 17, 176, 14, 178, 62, 135, 128, 145, 164, 50, 73, 47, 109, 101, 110, 155, 180, 139, 25, 57, 90, 144, 66, 60, 6, 190, 71, 251, 137, 45, 76, 24, 201, 169, 252, 0, 84, 233, 153, 21, 115, 89, 32, 125, 164, 85, 237, 76, 84, 69, 152, 125, 253, 231, 203, 81, 171, 116, 115, 102, 102, 66, 83, 205, 42, 188, 219, 141, 74, 109, 214, 166, 29, 165, 77, 159, 202, 213, 165, 172, 58, 97, 94, 55, 98, 21, 72, 130, 150, 165, 212, 42, 151, 255, 67, 34, 236, 87, 113, 221, 8, 245, 204, 94, 238, 192, 0, 136, 74, 123, 178, 15, 2, 214, 106, 160, 144, 214, 153, 76, 196, 125, 223, 173, 104, 90, 9, 239, 131, 25, 232, 141, 98, 9, 182, 154, 156, 133, 126, 217, 63, 151, 210, 247, 207, 122, 82, 146, 208, 14, 13, 7, 64, 151, 39, 18, 30, 9, 251, 45, 162, 106, 72, 148, 92, 194, 138, 19, 25, 246, 47, 26, 131, 235, 30, 45, 111, 8, 92, 67, 204, 126, 153, 117, 150, 164, 112, 11, 32, 243, 252, 44, 145, 9, 175, 25, 229, 136, 167, 242, 4, 5, 166, 35, 166, 215, 127, 240, 22, 0, 150, 192, 230, 255, 100, 187, 194, 120, 182, 67, 3, 20, 174, 198, 115, 249, 224, 139, 3, 112, 7, 215, 64, 172, 193, 103, 156, 24, 90, 66, 50, 107, 244, 142, 124, 6, 49, 222, 176, 148, 93, 108, 93, 59, 179, 186, 168, 146, 82, 188, 87, 131, 168, 188, 120, 97, 192, 87, 30, 44, 244, 198, 66, 11, 13, 70, 113, 254, 146, 67, 64, 115, 105, 193, 230, 21, 209, 114, 223, 92, 171, 240, 227, 132, 107, 75, 128, 205, 155, 226, 89, 107, 186, 214, 116, 236, 232, 3, 157, 233, 39, 84, 7, 54, 234, 206, 138, 220, 106, 213, 136, 89, 40, 225, 68, 126, 78, 99, 15, 227, 20, 41, 11, 167, 230, 23, 20, 233, 45, 224, 223, 237, 252, 153, 63, 107, 143, 185, 113, 146, 74, 100, 58, 80, 64, 118, 4, 235, 239, 146, 203, 137, 141, 174, 198, 219, 1, 0, 160, 197, 48, 206, 67, 49, 222, 120, 151, 59, 66, 201, 189, 253, 250, 210, 104, 237, 3, 152, 107, 234, 73, 25, 199, 31, 146, 169, 180, 118, 107, 244, 246, 141, 89, 179, 17, 194, 102, 202, 42, 234, 9, 135, 79, 205, 147, 154, 32, 125, 224, 140, 223, 60, 178, 17, 209, 254, 0, 56, 115, 60, 158, 121, 145, 255, 151, 206, 55, 203, 223, 13, 18, 62, 116, 89, 187, 152, 236, 60, 89, 155, 109, 149, 214, 103, 189, 31, 66, 57, 195, 156, 154, 111, 217, 1, 78, 11, 150, 97, 132, 72, 81, 74, 157, 79, 131, 149, 42, 144, 106, 235, 84, 89, 254, 124, 30, 104, 99, 253, 253, 221, 214, 104, 240, 93, 185, 91, 126, 173, 137, 93, 252, 1, 39, 212, 72, 46, 205, 134, 104, 239, 104, 93, 252, 75, 125, 88, 14, 226, 43, 150, 197, 75, 33, 37, 167, 21, 86, 94, 58, 20, 166, 190, 42, 21, 83, 114, 159, 116, 48, 4, 48, 71, 241, 214, 173, 60, 63, 19, 240, 134, 153, 201, 203, 201, 47, 73, 192, 198, 172, 233, 59, 255, 117, 59, 247, 168, 0, 6, 147, 28, 130, 2, 214, 121, 150, 102, 9, 11, 111, 178, 230, 90, 105, 251, 101, 93, 112, 175, 94, 81, 253, 48, 40, 52, 169, 252, 215, 160, 96, 247, 223, 93, 26, 215, 226, 25, 54, 47, 52, 93, 194, 62, 82, 189, 165, 13, 197, 122, 206, 63, 144, 98, 21, 216, 64, 88, 96, 125, 124, 215, 78, 79, 184, 165, 42, 105, 226, 172, 19, 132, 34, 238, 224, 198, 34, 128, 210, 211, 22, 21, 175, 70, 94, 99, 45, 153, 198, 111, 62, 65, 116, 236, 241, 16, 178, 204, 239, 82, 8, 117, 202, 90, 38, 104, 144, 41, 118, 29, 13, 231, 188, 35, 72, 31, 85, 77, 212, 155, 147, 136, 106, 1, 215, 6, 227, 115, 168, 99, 23, 207, 15, 53, 187, 184, 125, 61, 52, 20, 231, 237, 97, 77, 47, 22, 61, 116, 235, 146, 13, 132, 165, 254, 135, 255, 16, 173, 155, 184, 85, 149, 102, 131, 184, 139, 217, 180, 59, 232, 190, 5, 204, 44, 65, 111, 165, 52, 119, 84, 50, 206, 178, 168, 41, 147, 203, 56, 215, 254, 104, 158, 96, 13, 218, 184, 173, 74, 116, 236, 14, 134, 73, 45, 121, 24, 1, 38, 74, 246, 153, 222, 126, 99, 229, 187, 8, 164, 158, 20, 179, 140, 136, 208, 241, 64, 14, 156, 129, 165, 0, 224, 150, 95, 49, 59, 111, 29, 9, 155, 93, 125, 243, 116, 119, 31, 170, 219, 135, 127, 27, 65, 42, 156, 127, 184, 93, 172, 144, 69, 88, 69, 195, 80, 213, 154, 141, 83, 220, 223, 199, 120, 104, 41, 215, 153, 146, 196, 43, 213, 68, 102, 143, 106, 191, 217, 188, 7, 203, 151, 153, 232, 221, 182, 72, 174, 156, 231, 63, 11, 78, 230, 63, 22, 230, 242, 146, 104, 217, 243, 110, 18, 251, 27, 30, 122, 49, 120, 101, 41, 174, 225, 71, 27, 20, 201, 172, 79, 5, 5, 108, 168, 98, 9, 14, 99, 8, 134, 186, 12, 3, 218, 90, 39, 222, 2, 181, 145, 164, 66, 226, 197, 212, 167, 143, 41, 139, 42, 172, 25, 231, 190, 162, 195, 107, 19, 165, 203, 37, 48, 91, 7, 18, 141, 186, 250, 75, 73, 30, 156, 9, 111, 201, 156, 197, 198, 128, 70, 228, 176, 88, 75, 115, 101, 17, 80, 67, 114, 149, 251, 29, 244, 58, 59, 221, 227, 167, 182, 59, 225, 183, 33, 58, 166, 33, 8, 35, 151, 153, 150, 175, 152, 92, 100, 203, 91, 216, 55, 196, 234, 85, 179, 224, 146, 53, 146, 220, 214, 190, 216, 160, 135, 171, 73, 21, 17, 174, 142, 147, 3, 119, 208, 85, 222, 9, 49, 39, 244, 216, 157, 106, 106, 184, 90, 228, 48, 1, 117, 158, 2, 148, 176, 72, 203, 140, 159, 128, 156, 220, 83, 193, 100, 154, 186, 196, 1, 42, 169, 173, 65, 125, 132, 135, 104, 165, 47, 1, 221, 141, 184, 247, 31, 120, 171, 62, 248, 30, 103, 37, 62, 123, 99, 255, 41, 74, 236, 141, 2, 213, 204, 182, 125, 137, 66, 235, 115, 248, 46, 152, 176, 92, 231, 165, 244, 209, 212, 250, 197, 229, 164, 202, 48, 244, 229, 76, 163, 221, 248, 209, 249, 203, 183, 168, 101, 38, 33, 187, 147, 85, 34, 127, 53, 134, 203, 120, 245, 229, 23, 230, 141, 49, 131, 56, 122, 2, 216, 198, 86, 119, 47, 95, 102, 42, 231, 250, 148, 87, 176, 25, 218, 208, 150, 29, 200, 61, 39, 110, 224, 5, 19, 221, 79, 251, 230, 137, 238, 98, 53, 68, 229, 208, 42, 79, 31, 250, 103, 1, 252, 205, 0, 135, 184, 82, 143, 105, 118, 86, 47, 27, 45, 38, 108, 82, 86, 170, 8, 157, 168, 125, 65, 235, 31, 59, 22, 236, 108, 211, 126, 2, 142, 172, 62, 93, 149, 59, 77, 16, 175, 29, 121, 69, 108, 124, 231, 97, 53, 76, 102, 37, 44, 130, 23, 99, 233, 151, 191, 229, 137, 238, 171, 32, 177, 48, 188, 97, 177, 153, 203, 169, 126, 52, 216, 180, 217, 39, 180, 232, 73, 227, 164, 157, 238, 55, 54, 83, 93, 175, 120, 40, 83, 173, 238, 220, 176, 75, 249, 207, 199, 111, 190, 121, 165, 85, 86, 188, 40, 31, 213, 159, 21, 242, 91, 255, 209, 161, 225, 68, 157, 117, 122, 143, 110, 48, 60, 135, 85, 214, 10, 60, 32, 19, 62, 91, 81, 169, 49, 147, 115, 32, 153, 9, 140, 28, 50, 175, 128, 245, 168, 17, 56, 12, 182, 125, 86, 72, 163, 240, 120, 34, 45, 253, 182, 218, 251, 218, 98, 68, 73, 137, 151, 83, 161, 80, 57, 124, 85, 152, 76, 72, 164, 212, 6, 155, 99, 242, 229, 190, 131, 70, 47, 172, 8, 157, 79, 150, 217, 68, 153, 39, 187, 223, 254, 113, 219, 242, 199, 37, 48, 209, 192, 18, 146, 208, 108, 244, 35, 91, 184, 145, 133, 238, 180, 0, 46, 205, 170, 29, 23, 85, 89, 72, 203, 184, 112, 24, 68, 69, 129, 104, 254, 189, 179, 183, 215, 193, 218, 98, 20, 205, 102, 240, 20, 138, 26, 41, 178, 98, 11, 147, 115, 66, 102, 253, 109, 50, 177, 168, 33, 108, 172, 134, 225, 28, 25, 163, 11, 167, 239, 161, 61, 35, 102, 230, 40, 224, 151, 185, 85, 255, 69, 130, 138, 222, 13, 68, 159];
const CUSTOM_WRITE_PROC: [u8; 4176] = [97, 116, 100, 100, 0, 0, 205, 5, 250, 105, 14, 18, 145, 80, 69, 90, 165, 16, 247, 215, 234, 71, 105, 162, 0, 0, 0, 0, 0, 24, 167, 85, 177, 115, 65, 228, 168, 213, 22, 237, 0, 0, 0, 0, 0, 0, 0, 215, 238, 175, 7, 29, 100, 113, 98, 36, 225, 187, 114, 140, 179, 254, 24, 78, 41, 59, 2, 73, 200, 64, 133, 146, 27, 160, 243, 44, 228, 184, 174, 45, 16, 116, 47, 20, 189, 146, 194, 161, 179, 80, 99, 116, 117, 93, 111, 209, 243, 133, 116, 165, 122, 222, 197, 145, 0, 97, 131, 180, 133, 178, 122, 122, 54, 2, 188, 152, 144, 167, 112, 113, 225, 215, 86, 198, 56, 178, 5, 222, 228, 120, 239, 233, 76, 54, 147, 241, 147, 35, 144, 83, 238, 163, 43, 1, 1, 12, 40, 154, 84, 160, 115, 72, 210, 161, 236, 80, 100, 202, 3, 87, 23, 135, 59, 188, 70, 4, 17, 89, 80, 57, 188, 13, 24, 9, 229, 185, 200, 173, 136, 65, 243, 122, 2, 168, 102, 134, 81, 177, 119, 129, 126, 61, 213, 252, 17, 225, 244, 8, 123, 55, 159, 81, 30, 235, 228, 158, 150, 196, 240, 204, 84, 62, 130, 57, 157, 73, 40, 255, 224, 246, 98, 234, 241, 228, 77, 147, 62, 233, 35, 2, 130, 29, 128, 59, 0, 190, 251, 137, 113, 226, 113, 38, 163, 130, 65, 240, 97, 212, 25, 14, 232, 201, 136, 196, 71, 229, 213, 147, 51, 155, 46, 252, 98, 145, 19, 105, 77, 105, 248, 129, 18, 241, 94, 215, 175, 81, 141, 59, 239, 114, 172, 197, 130, 154, 127, 11, 66, 246, 145, 19, 171, 63, 61, 84, 160, 190, 120, 29, 213, 129, 71, 222, 87, 35, 194, 28, 177, 91, 45, 199, 42, 102, 10, 134, 131, 81, 207, 114, 137, 244, 50, 3, 250, 19, 147, 146, 221, 80, 34, 252, 206, 61, 218, 114, 181, 113, 215, 245, 63, 182, 14, 216, 105, 18, 27, 5, 35, 99, 64, 86, 211, 194, 38, 81, 114, 252, 111, 153, 67, 187, 172, 240, 195, 177, 98, 56, 131, 202, 70, 128, 38, 20, 145, 80, 89, 111, 71, 184, 109, 151, 226, 233, 125, 184, 249, 216, 204, 90, 145, 149, 52, 204, 21, 58, 132, 88, 81, 231, 105, 19, 255, 150, 54, 15, 79, 187, 144, 34, 28, 18, 24, 206, 238, 15, 92, 223, 43, 219, 182, 47, 243, 60, 155, 70, 148, 189, 133, 173, 196, 159, 209, 248, 197, 252, 91, 214, 239, 34, 129, 62, 249, 13, 183, 186, 181, 30, 210, 210, 245, 254, 74, 224, 94, 96, 16, 7, 4, 50, 81, 143, 73, 74, 115, 117, 22, 248, 78, 142, 131, 74, 210, 243, 105, 49, 151, 25, 244, 249, 97, 241, 123, 207, 56, 156, 176, 52, 189, 159, 16, 205, 90, 56, 212, 123, 111, 40, 215, 253, 219, 190, 30, 63, 155, 210, 85, 120, 111, 130, 31, 89, 210, 14, 56, 220, 228, 71, 41, 138, 201, 249, 71, 236, 208, 224, 176, 183, 116, 21, 32, 91, 53, 205, 103, 25, 159, 176, 32, 162, 65, 165, 239, 236, 186, 218, 143, 205, 18, 220, 152, 88, 37, 34, 110, 68, 104, 63, 51, 88, 85, 179, 45, 176, 235, 64, 237, 37, 155, 205, 79, 165, 192, 200, 214, 78, 153, 179, 255, 241, 178, 57, 181, 232, 245, 168, 12, 194, 137, 84, 209, 3, 101, 170, 172, 131, 161, 55, 7, 170, 200, 99, 22, 176, 195, 229, 85, 118, 110, 227, 157, 101, 183, 246, 135, 8, 19, 178, 214, 32, 86, 113, 104, 38, 128, 75, 219, 230, 158, 198, 53, 26, 231, 238, 75, 246, 224, 181, 61, 57, 78, 81, 139, 245, 244, 241, 144, 160, 49, 94, 211, 18, 222, 250, 91, 178, 31, 103, 1, 161, 13, 130, 133, 145, 126, 74, 127, 241, 86, 176, 249, 65, 170, 215, 213, 145, 239, 216, 5, 43, 47, 99, 224, 116, 167, 226, 108, 136, 151, 36, 2, 63, 91, 244, 246, 211, 37, 179, 250, 125, 46, 69, 234, 57, 66, 186, 51, 226, 223, 227, 139, 137, 25, 18, 251, 79, 37, 144, 212, 86, 62, 249, 187, 135, 171, 7, 141, 127, 28, 103, 78, 124, 128, 71, 140, 36, 71, 155, 227, 68, 208, 185, 58, 167, 164, 99, 94, 26, 204, 115, 72, 190, 203, 101, 212, 188, 76, 116, 231, 35, 131, 76, 109, 227, 79, 179, 98, 254, 76, 80, 64, 209, 1, 233, 110, 163, 86, 218, 175, 73, 111, 5, 93, 110, 161, 46, 196, 109, 145, 58, 164, 183, 240, 209, 41, 159, 102, 137, 238, 88, 49, 16, 230, 164, 133, 247, 128, 174, 3, 202, 206, 143, 255, 217, 243, 137, 13, 126, 77, 97, 235, 161, 99, 227, 106, 252, 178, 117, 40, 45, 205, 154, 134, 151, 125, 101, 161, 79, 134, 169, 21, 179, 87, 232, 164, 21, 85, 26, 198, 143, 118, 22, 238, 244, 23, 198, 91, 48, 199, 217, 201, 99, 114, 210, 251, 70, 189, 141, 225, 139, 83, 209, 126, 101, 162, 94, 90, 40, 158, 49, 25, 159, 237, 12, 158, 86, 170, 241, 63, 103, 150, 12, 71, 188, 31, 184, 119, 25, 206, 26, 218, 47, 199, 245, 131, 229, 173, 70, 223, 231, 204, 87, 91, 26, 28, 93, 173, 174, 169, 139, 45, 106, 57, 142, 174, 18, 12, 146, 61, 249, 184, 171, 134, 67, 64, 4, 84, 165, 248, 242, 50, 236, 178, 18, 115, 158, 228, 38, 64, 28, 230, 31, 108, 162, 238, 108, 120, 76, 42, 85, 151, 207, 238, 121, 60, 123, 244, 15, 101, 108, 193, 88, 206, 51, 15, 220, 59, 28, 217, 2, 100, 191, 60, 31, 238, 172, 163, 166, 124, 190, 237, 22, 123, 147, 61, 244, 115, 149, 142, 233, 206, 4, 47, 1, 40, 223, 240, 32, 165, 209, 118, 183, 4, 222, 60, 169, 2, 227, 77, 163, 171, 165, 69, 85, 82, 146, 116, 173, 170, 172, 117, 8, 202, 122, 50, 54, 134, 167, 175, 17, 192, 10, 88, 19, 203, 38, 108, 240, 13, 49, 227, 85, 74, 239, 176, 121, 172, 1, 235, 48, 117, 212, 103, 133, 182, 60, 9, 0, 71, 21, 5, 112, 52, 96, 190, 78, 200, 220, 86, 28, 232, 21, 171, 228, 136, 49, 41, 206, 116, 70, 176, 165, 130, 75, 254, 242, 167, 124, 64, 98, 215, 210, 224, 1, 247, 132, 58, 144, 160, 58, 103, 172, 76, 15, 198, 73, 254, 248, 147, 198, 220, 122, 47, 188, 216, 126, 62, 18, 15, 1, 84, 36, 161, 250, 48, 158, 92, 90, 168, 227, 100, 99, 201, 174, 161, 190, 228, 128, 247, 99, 207, 24, 155, 72, 170, 6, 155, 70, 125, 2, 158, 178, 37, 19, 86, 21, 246, 223, 55, 132, 92, 82, 236, 168, 136, 194, 226, 75, 199, 6, 155, 85, 50, 88, 94, 49, 84, 26, 194, 160, 71, 121, 110, 133, 121, 47, 210, 162, 152, 160, 173, 223, 9, 33, 244, 153, 159, 198, 15, 12, 150, 163, 100, 234, 91, 122, 86, 97, 206, 38, 170, 254, 65, 103, 28, 20, 23, 176, 150, 31, 176, 147, 70, 79, 94, 175, 179, 240, 56, 10, 154, 147, 143, 33, 76, 147, 61, 72, 45, 155, 155, 186, 63, 34, 71, 168, 164, 119, 102, 84, 228, 206, 122, 74, 214, 207, 246, 54, 227, 230, 50, 16, 207, 70, 253, 108, 98, 127, 7, 150, 193, 135, 46, 182, 166, 163, 127, 140, 205, 75, 157, 22, 0, 75, 154, 26, 109, 228, 171, 204, 58, 208, 80, 134, 180, 44, 87, 108, 86, 58, 77, 142, 164, 141, 47, 52, 12, 207, 173, 36, 169, 60, 186, 154, 205, 75, 201, 244, 137, 120, 67, 24, 42, 33, 124, 242, 61, 31, 147, 23, 11, 209, 215, 127, 133, 229, 135, 204, 129, 148, 189, 95, 4, 216, 115, 106, 114, 173, 245, 101, 238, 42, 26, 61, 57, 63, 90, 157, 50, 111, 118, 71, 67, 211, 135, 28, 31, 91, 151, 181, 117, 251, 255, 114, 204, 89, 205, 240, 145, 225, 75, 131, 175, 84, 196, 179, 246, 168, 180, 63, 152, 73, 255, 177, 41, 193, 204, 16, 64, 35, 201, 250, 163, 126, 145, 92, 4, 74, 190, 46, 82, 151, 164, 215, 250, 146, 133, 66, 178, 97, 50, 228, 67, 220, 28, 27, 221, 182, 118, 252, 100, 158, 83, 33, 177, 175, 206, 40, 47, 116, 179, 214, 111, 245, 213, 137, 144, 183, 6, 131, 138, 224, 12, 225, 188, 173, 117, 57, 185, 198, 131, 170, 149, 0, 117, 253, 178, 49, 236, 244, 163, 127, 58, 157, 219, 1, 106, 182, 161, 100, 62, 59, 169, 23, 163, 221, 52, 132, 216, 221, 102, 251, 200, 168, 99, 89, 85, 164, 90, 119, 98, 107, 78, 1, 85, 203, 233, 0, 85, 114, 58, 238, 88, 32, 47, 241, 222, 251, 40, 25, 187, 83, 2, 143, 182, 134, 40, 99, 94, 16, 92, 35, 25, 150, 165, 230, 129, 122, 24, 191, 50, 5, 32, 148, 175, 232, 179, 2, 70, 8, 66, 13, 104, 27, 24, 4, 60, 133, 57, 162, 97, 189, 39, 132, 228, 165, 193, 172, 227, 192, 239, 57, 171, 94, 120, 178, 105, 27, 92, 169, 65, 25, 250, 69, 231, 133, 32, 139, 217, 111, 130, 13, 106, 95, 102, 248, 116, 13, 187, 192, 68, 202, 181, 16, 38, 101, 56, 90, 230, 2, 154, 16, 148, 119, 144, 180, 194, 223, 218, 186, 0, 181, 160, 24, 31, 245, 61, 126, 86, 148, 79, 143, 117, 251, 205, 232, 28, 69, 199, 117, 126, 191, 23, 191, 213, 36, 196, 124, 45, 201, 4, 215, 158, 59, 124, 223, 26, 19, 220, 56, 44, 94, 202, 85, 12, 135, 244, 110, 44, 59, 112, 21, 229, 119, 121, 132, 133, 114, 251, 148, 204, 208, 209, 154, 104, 115, 73, 38, 144, 153, 51, 192, 63, 150, 144, 146, 66, 81, 85, 232, 17, 1, 218, 188, 199, 194, 249, 250, 105, 14, 92, 212, 238, 134, 104, 75, 132, 197, 120, 187, 170, 191, 142, 104, 0, 242, 121, 55, 132, 186, 143, 225, 184, 227, 18, 2, 102, 84, 237, 115, 105, 230, 11, 202, 255, 226, 9, 155, 53, 131, 45, 52, 169, 41, 143, 250, 248, 141, 104, 182, 52, 41, 116, 120, 1, 27, 254, 131, 254, 175, 123, 154, 43, 239, 185, 204, 15, 126, 152, 254, 119, 169, 209, 233, 230, 180, 194, 125, 58, 138, 16, 180, 123, 65, 172, 140, 8, 151, 154, 182, 138, 140, 112, 55, 104, 239, 182, 82, 75, 46, 82, 110, 215, 7, 242, 7, 209, 127, 213, 192, 135, 202, 17, 49, 201, 123, 243, 62, 63, 85, 73, 183, 150, 183, 94, 199, 183, 43, 109, 87, 98, 2, 251, 108, 170, 114, 128, 52, 43, 232, 110, 226, 68, 3, 65, 98, 180, 27, 24, 223, 22, 252, 144, 162, 99, 176, 188, 143, 160, 244, 111, 214, 177, 230, 151, 41, 210, 17, 204, 25, 119, 165, 231, 90, 4, 45, 98, 218, 40, 241, 196, 143, 96, 136, 169, 199, 149, 158, 41, 56, 69, 163, 234, 188, 210, 39, 254, 213, 48, 249, 153, 239, 58, 5, 228, 125, 119, 207, 180, 87, 6, 99, 2, 26, 158, 79, 67, 188, 253, 200, 253, 167, 64, 119, 163, 80, 184, 7, 178, 26, 89, 68, 36, 131, 9, 33, 64, 159, 100, 109, 38, 18, 77, 121, 1, 26, 210, 192, 210, 110, 135, 47, 24, 90, 145, 105, 57, 131, 131, 225, 243, 40, 212, 20, 229, 19, 111, 79, 142, 171, 55, 104, 60, 113, 182, 10, 192, 100, 190, 112, 24, 247, 90, 28, 96, 156, 88, 112, 173, 144, 223, 117, 131, 201, 122, 186, 11, 118, 79, 182, 247, 37, 231, 146, 117, 242, 194, 113, 188, 210, 239, 121, 231, 100, 54, 229, 240, 98, 215, 41, 190, 108, 64, 43, 189, 9, 188, 209, 64, 82, 139, 6, 144, 83, 35, 139, 95, 222, 159, 173, 3, 1, 31, 130, 255, 75, 162, 125, 4, 62, 82, 1, 78, 51, 142, 193, 249, 110, 171, 159, 154, 20, 230, 167, 127, 106, 94, 7, 192, 0, 250, 11, 150, 47, 104, 165, 215, 100, 98, 171, 16, 145, 29, 91, 228, 203, 4, 41, 211, 127, 12, 229, 195, 118, 55, 121, 17, 42, 173, 63, 16, 155, 128, 37, 244, 235, 190, 140, 127, 204, 4, 124, 13, 252, 52, 146, 231, 8, 91, 251, 72, 79, 116, 7, 167, 152, 221, 133, 137, 127, 151, 28, 253, 93, 252, 253, 49, 13, 27, 111, 174, 235, 69, 148, 93, 200, 46, 228, 228, 95, 207, 200, 109, 166, 138, 254, 199, 127, 155, 142, 225, 28, 49, 107, 222, 126, 140, 75, 129, 86, 53, 42, 148, 75, 150, 109, 138, 28, 198, 142, 111, 160, 181, 204, 119, 77, 121, 150, 4, 54, 50, 153, 144, 182, 208, 124, 223, 140, 97, 29, 241, 230, 150, 144, 75, 74, 75, 247, 249, 13, 234, 191, 54, 180, 38, 66, 40, 213, 109, 17, 36, 223, 86, 45, 57, 115, 12, 143, 68, 160, 152, 199, 237, 18, 67, 167, 162, 251, 121, 69, 34, 46, 34, 28, 60, 35, 65, 209, 86, 136, 88, 188, 115, 9, 228, 202, 69, 59, 153, 70, 101, 185, 204, 119, 13, 142, 213, 246, 39, 4, 194, 167, 185, 198, 165, 222, 8, 83, 185, 213, 35, 234, 182, 113, 118, 177, 147, 249, 244, 52, 230, 235, 53, 173, 121, 123, 148, 67, 242, 187, 178, 144, 59, 196, 8, 199, 159, 41, 89, 72, 64, 115, 124, 83, 3, 245, 176, 199, 50, 37, 226, 132, 188, 81, 245, 178, 86, 178, 164, 120, 2, 113, 130, 208, 142, 70, 82, 159, 180, 172, 35, 111, 178, 202, 241, 177, 230, 125, 116, 154, 81, 250, 217, 27, 202, 210, 18, 56, 97, 198, 108, 161, 227, 70, 212, 43, 87, 10, 149, 244, 105, 27, 66, 79, 236, 64, 231, 119, 24, 34, 174, 151, 50, 33, 98, 173, 76, 198, 241, 54, 24, 176, 72, 165, 159, 230, 58, 209, 178, 62, 145, 201, 57, 190, 221, 150, 214, 193, 155, 85, 194, 61, 178, 223, 143, 173, 185, 63, 187, 193, 190, 21, 36, 231, 89, 92, 69, 0, 106, 139, 255, 109, 33, 45, 139, 92, 1, 212, 123, 126, 190, 218, 238, 247, 109, 68, 28, 161, 179, 239, 236, 253, 63, 23, 34, 48, 11, 15, 51, 28, 108, 190, 215, 30, 206, 12, 185, 62, 40, 114, 43, 198, 229, 110, 65, 23, 152, 9, 181, 118, 16, 188, 153, 132, 242, 95, 7, 106, 95, 65, 123, 107, 36, 34, 250, 92, 114, 108, 72, 98, 179, 62, 137, 125, 162, 18, 178, 22, 140, 57, 91, 170, 20, 143, 118, 24, 146, 168, 212, 51, 234, 94, 65, 248, 233, 120, 245, 163, 19, 162, 215, 101, 219, 39, 113, 110, 46, 150, 53, 243, 139, 11, 91, 44, 83, 106, 213, 125, 221, 98, 19, 5, 187, 14, 70, 62, 190, 60, 240, 151, 97, 228, 186, 0, 90, 91, 243, 140, 246, 249, 188, 233, 90, 118, 14, 254, 216, 144, 102, 9, 115, 214, 3, 17, 199, 138, 62, 131, 88, 238, 22, 169, 104, 149, 76, 150, 95, 233, 203, 71, 248, 115, 210, 27, 39, 165, 159, 200, 9, 71, 6, 239, 31, 210, 14, 200, 141, 163, 169, 54, 30, 137, 203, 227, 215, 61, 206, 242, 174, 86, 202, 65, 159, 7, 182, 245, 115, 8, 53, 33, 1, 62, 67, 126, 45, 126, 71, 239, 216, 147, 182, 111, 65, 255, 152, 238, 102, 196, 117, 19, 72, 183, 235, 41, 157, 105, 129, 118, 148, 85, 68, 234, 93, 226, 17, 176, 14, 178, 62, 135, 128, 145, 164, 50, 73, 47, 109, 101, 110, 155, 180, 139, 25, 57, 90, 144, 66, 60, 6, 190, 71, 251, 137, 45, 76, 24, 201, 169, 252, 0, 84, 233, 153, 21, 115, 89, 32, 125, 164, 85, 237, 76, 84, 69, 152, 125, 253, 231, 203, 81, 171, 116, 115, 102, 102, 66, 83, 205, 42, 188, 219, 141, 74, 109, 214, 166, 29, 165, 77, 159, 202, 213, 165, 172, 58, 97, 94, 55, 98, 21, 72, 130, 150, 165, 212, 42, 151, 255, 67, 34, 236, 87, 113, 221, 8, 245, 204, 94, 238, 192, 0, 136, 74, 123, 178, 15, 2, 214, 106, 160, 144, 214, 153, 76, 196, 125, 223, 173, 104, 90, 9, 239, 131, 25, 232, 141, 98, 9, 182, 154, 156, 133, 126, 217, 63, 151, 210, 247, 207, 122, 82, 146, 208, 14, 13, 7, 64, 151, 39, 18, 30, 9, 251, 45, 162, 106, 72, 148, 92, 194, 138, 19, 25, 246, 47, 26, 131, 235, 30, 45, 111, 8, 92, 67, 204, 126, 153, 117, 150, 164, 112, 11, 32, 243, 252, 44, 145, 9, 175, 25, 229, 136, 167, 242, 4, 5, 166, 35, 166, 215, 127, 240, 22, 0, 150, 192, 230, 255, 100, 187, 194, 120, 182, 67, 3, 20, 174, 198, 115, 249, 224, 139, 3, 112, 7, 215, 64, 172, 193, 103, 156, 24, 90, 66, 50, 107, 244, 142, 124, 6, 49, 222, 176, 148, 93, 108, 93, 59, 179, 186, 168, 146, 82, 188, 87, 131, 168, 188, 120, 97, 192, 87, 30, 44, 244, 198, 66, 11, 13, 70, 113, 254, 146, 67, 64, 115, 105, 193, 230, 21, 209, 114, 223, 92, 171, 240, 227, 132, 107, 75, 128, 205, 155, 226, 89, 107, 186, 214, 116, 236, 232, 3, 157, 233, 39, 84, 7, 54, 234, 206, 138, 220, 106, 213, 136, 89, 40, 225, 68, 126, 78, 99, 15, 227, 20, 41, 11, 167, 230, 23, 20, 233, 45, 224, 223, 237, 252, 153, 63, 107, 143, 185, 113, 146, 74, 100, 58, 80, 64, 118, 4, 235, 239, 146, 203, 137, 141, 174, 198, 219, 1, 0, 160, 197, 48, 206, 67, 49, 222, 120, 151, 59, 66, 201, 189, 253, 250, 210, 104, 237, 3, 152, 107, 234, 73, 25, 199, 31, 146, 169, 180, 118, 107, 244, 246, 141, 89, 179, 17, 194, 102, 202, 42, 234, 9, 135, 79, 205, 147, 154, 32, 125, 224, 140, 223, 60, 178, 17, 209, 254, 0, 56, 115, 60, 158, 121, 145, 255, 151, 206, 55, 203, 223, 13, 18, 62, 116, 89, 187, 152, 236, 60, 89, 155, 109, 149, 214, 103, 189, 31, 66, 57, 195, 156, 154, 111, 217, 1, 78, 11, 150, 97, 132, 72, 81, 74, 157, 79, 131, 149, 42, 144, 106, 235, 84, 89, 254, 124, 30, 104, 99, 253, 253, 221, 214, 104, 240, 93, 185, 91, 126, 173, 137, 93, 252, 1, 39, 212, 72, 46, 205, 134, 104, 239, 104, 93, 252, 75, 125, 88, 14, 226, 43, 150, 197, 75, 33, 37, 167, 21, 86, 94, 58, 20, 166, 190, 42, 21, 83, 114, 159, 116, 48, 4, 48, 71, 241, 214, 173, 60, 63, 19, 240, 134, 153, 201, 203, 201, 47, 73, 192, 198, 172, 233, 59, 255, 117, 59, 247, 168, 0, 6, 147, 28, 130, 2, 214, 121, 150, 102, 9, 11, 111, 178, 230, 90, 105, 251, 101, 93, 112, 175, 94, 81, 253, 48, 40, 52, 169, 252, 215, 160, 96, 247, 223, 93, 26, 215, 226, 25, 54, 47, 52, 93, 194, 62, 82, 189, 165, 13, 197, 122, 206, 63, 144, 98, 21, 216, 64, 88, 96, 125, 124, 215, 78, 79, 184, 165, 42, 105, 226, 172, 19, 132, 34, 238, 224, 198, 34, 128, 210, 211, 22, 21, 175, 70, 94, 99, 45, 153, 198, 111, 62, 65, 116, 236, 241, 16, 178, 204, 239, 82, 8, 117, 202, 90, 38, 104, 144, 41, 118, 29, 13, 231, 188, 35, 72, 31, 85, 77, 212, 155, 147, 136, 106, 1, 215, 6, 227, 115, 168, 99, 23, 207, 15, 53, 187, 184, 125, 61, 52, 20, 231, 237, 97, 77, 47, 22, 61, 116, 235, 146, 13, 132, 165, 254, 135, 255, 16, 173, 155, 184, 85, 149, 102, 131, 184, 139, 217, 180, 59, 232, 190, 5, 204, 44, 65, 111, 165, 52, 119, 84, 50, 206, 178, 168, 41, 147, 203, 56, 215, 254, 104, 158, 96, 13, 218, 184, 173, 74, 116, 236, 14, 134, 73, 45, 121, 24, 1, 38, 74, 246, 153, 222, 126, 99, 229, 187, 8, 164, 158, 20, 179, 140, 136, 208, 241, 64, 14, 156, 129, 165, 0, 224, 150, 95, 49, 59, 111, 29, 9, 155, 93, 125, 243, 116, 119, 31, 170, 219, 135, 127, 27, 65, 42, 156, 127, 184, 93, 172, 144, 69, 88, 69, 195, 80, 213, 154, 141, 83, 220, 223, 199, 120, 104, 41, 215, 153, 146, 196, 43, 213, 68, 102, 143, 106, 191, 217, 188, 7, 203, 151, 153, 232, 221, 182, 72, 174, 156, 231, 63, 11, 78, 230, 63, 22, 230, 242, 146, 104, 217, 243, 110, 18, 251, 27, 30, 122, 49, 120, 101, 41, 174, 225, 71, 27, 20, 201, 172, 79, 5, 5, 108, 168, 98, 9, 14, 99, 8, 134, 186, 12, 3, 218, 90, 39, 222, 2, 181, 145, 164, 66, 226, 197, 212, 167, 143, 41, 139, 42, 172, 25, 231, 190, 162, 195, 107, 19, 165, 203, 37, 48, 91, 7, 18, 141, 186, 250, 75, 73, 30, 156, 9, 111, 201, 156, 197, 198, 128, 70, 228, 176, 88, 75, 115, 101, 17, 80, 67, 114, 149, 251, 29, 244, 58, 59, 221, 227, 167, 182, 59, 225, 183, 33, 58, 166, 33, 8, 35, 151, 153, 150, 175, 152, 92, 100, 203, 91, 216, 55, 196, 234, 85, 179, 224, 146, 53, 146, 220, 214, 190, 216, 160, 135, 171, 73, 21, 17, 174, 142, 147, 3, 119, 208, 85, 222, 9, 49, 39, 244, 216, 157, 106, 106, 184, 90, 228, 48, 1, 117, 158, 2, 148, 176, 72, 203, 140, 159, 128, 156, 220, 83, 193, 100, 154, 186, 196, 1, 42, 169, 173, 65, 125, 132, 135, 104, 165, 47, 1, 221, 141, 184, 247, 31, 120, 171, 62, 248, 30, 103, 37, 62, 123, 99, 255, 41, 74, 236, 141, 2, 213, 204, 182, 125, 137, 66, 235, 115, 248, 46, 152, 176, 92, 231, 165, 244, 209, 212, 250, 197, 229, 164, 202, 48, 244, 229, 76, 163, 221, 248, 209, 249, 203, 183, 168, 101, 38, 33, 187, 147, 85, 34, 127, 53, 134, 203, 120, 245, 229, 23, 230, 141, 49, 131, 56, 122, 2, 216, 198, 86, 119, 47, 95, 102, 42, 231, 250, 148, 87, 176, 25, 218, 208, 150, 29, 200, 61, 39, 110, 224, 5, 19, 221, 79, 251, 230, 137, 238, 98, 53, 68, 229, 208, 42, 79, 31, 250, 103, 1, 252, 205, 0, 135, 184, 82, 143, 105, 118, 86, 47, 27, 45, 38, 108, 82, 86, 170, 8, 157, 168, 125, 65, 235, 31, 59, 22, 236, 108, 211, 126, 2, 142, 172, 62, 93, 149, 59, 77, 16, 175, 29, 121, 69, 108, 124, 231, 97, 53, 76, 102, 37, 44, 130, 23, 99, 233, 151, 191, 229, 137, 238, 171, 32, 177, 48, 188, 97, 177, 153, 203, 169, 126, 52, 216, 180, 217, 39, 180, 232, 73, 227, 164, 157, 238, 55, 54, 83, 93, 175, 120, 40, 83, 173, 238, 220, 176, 75, 249, 207, 199, 111, 190, 121, 165, 85, 86, 188, 40, 31, 213, 159, 21, 242, 91, 255, 209, 161, 225, 68, 157, 117, 122, 143, 110, 48, 60, 135, 85, 214, 10, 60, 32, 19, 62, 91, 81, 169, 49, 147, 115, 32, 153, 9, 140, 28, 50, 175, 128, 245, 168, 17, 56, 12, 182, 125, 86, 72, 163, 240, 120, 34, 45, 253, 182, 218, 251, 218, 98, 68, 73, 137, 151, 83, 161, 80, 57, 124, 85, 152, 76, 72, 164, 212, 6, 155, 99, 242, 229, 190, 131, 70, 47, 172, 8, 157, 79, 150, 217, 68, 153, 39, 187, 223, 254, 113, 219, 242, 199, 37, 48, 209, 192, 18, 146, 208, 108, 244, 35, 91, 184, 145, 133, 238, 180, 0, 46, 205, 170, 29, 23, 85, 89, 72, 203, 184, 112, 24, 68, 69, 129, 104, 254, 189, 179, 183, 215, 193, 218, 98, 20, 205, 102, 240, 20, 138, 26, 41, 178, 98, 11, 147, 115, 66, 102, 253, 109, 64, 40, 162, 18, 54, 192, 207, 194, 25, 192, 252, 160, 186, 77, 88, 168, 5, 121, 199, 147, 89, 195, 242, 136, 64, 11, 50, 3, 100, 239, 162, 26];
const CUSTOM_ACK: [u8; 64] = [97, 116, 100, 100, 0, 0, 205, 6, 250, 105, 14, 18, 145, 80, 69, 90, 165, 16, 247, 215, 234, 71, 105, 162, 0, 0, 0, 0, 0, 24, 167, 85, 234, 111, 40, 71, 205, 227, 29, 82, 222, 3, 134, 141, 199, 246, 210, 21, 255, 169, 74, 183, 163, 170, 120, 232, 145, 17, 166, 201, 169, 167, 166, 214];

#[tokio::test]
#[timeout(200)]
async fn read_serialized_correctly() {
    // given
    let request_identifier = 12786636217375856365_u64;
    let sector_idx = 1615701_u64;
    let register_cmd = RegisterCommand::Client(ClientRegisterCommand {
        header: ClientCommandHeader {
            request_identifier,
            sector_idx,
        },
        content: ClientRegisterCommandContent::Read,
    });
    let mut sink: Vec<u8> = Vec::new();

    // when
    serialize_register_command(&register_cmd, &mut sink, &CUSTOM_HMAC_CLIENT_KEY)
        .await
        .expect("Could not serialize?");

    assert_eq!(sink, CUSTOM_READ.to_vec());
}
#[tokio::test]
#[timeout(200)]
async fn write_serialized_correctly() {
    // given
    let request_identifier = 12786636217375856365_u64;
    let sector_idx = 1615701_u64;
    let sector = CUSTOM_SECTOR.to_vec();
    let register_cmd = RegisterCommand::Client(ClientRegisterCommand {
        header: ClientCommandHeader {
            request_identifier,
            sector_idx,
        },
        content: ClientRegisterCommandContent::Write {
            data: SectorVec(sector.clone()),
        },
    });
    let mut sink: Vec<u8> = Vec::new();

    // when
    serialize_register_command(&register_cmd, &mut sink, &CUSTOM_HMAC_CLIENT_KEY)
        .await
        .expect("Could not serialize?");

    assert_eq!(sink, CUSTOM_WRITE.to_vec());
}

#[tokio::test]
#[timeout(200)]
async fn read_proc_serialized_correctly() {
    // given
    let process_identifier = 205_u8;
    let msg_ident = Uuid::from_bytes(CUSTOM_UUID_BYTES);
    let sector_idx = 1615701_u64;
    let register_cmd = RegisterCommand::System(SystemRegisterCommand {
        header: SystemCommandHeader {
            process_identifier,
            msg_ident,
            sector_idx
        },
        content: SystemRegisterCommandContent::ReadProc,
    });
    let mut sink: Vec<u8> = Vec::new();

    // when
    serialize_register_command(&register_cmd, &mut sink, &CUSTOM_HMAC_SYSTEM_KEY)
        .await
        .expect("Could not serialize?");

    assert_eq!(sink, CUSTOM_READ_PROC.to_vec());
}

#[tokio::test]
#[timeout(200)]
async fn value_serialized_correctly() {
    // given
    let process_identifier = 205_u8;
    let msg_ident = Uuid::from_bytes(CUSTOM_UUID_BYTES);
    let sector_idx = 1615701_u64;
    let timestamp = 12786636217375856365_u64;
    let write_rank = 215_u8;
    let sector = CUSTOM_SECTOR.to_vec();
    let register_cmd = RegisterCommand::System(SystemRegisterCommand {
        header: SystemCommandHeader {
            process_identifier,
            msg_ident,
            sector_idx
        },
        content: SystemRegisterCommandContent::Value {
            timestamp,
            write_rank,
            sector_data: SectorVec(sector.clone()),
        },
    });
    let mut sink: Vec<u8> = Vec::new();

    // when
    serialize_register_command(&register_cmd, &mut sink, &CUSTOM_HMAC_SYSTEM_KEY)
        .await
        .expect("Could not serialize?");

    assert_eq!(sink, CUSTOM_VALUE.to_vec());
}

#[tokio::test]
#[timeout(200)]
async fn write_proc_serialized_correctly() {
    // given
    let process_identifier = 205_u8;
    let msg_ident = Uuid::from_bytes(CUSTOM_UUID_BYTES);
    let sector_idx = 1615701_u64;
    let timestamp = 12786636217375856365_u64;
    let write_rank = 215_u8;
    let sector = CUSTOM_SECTOR.to_vec();
    let register_cmd = RegisterCommand::System(SystemRegisterCommand {
        header: SystemCommandHeader {
            process_identifier,
            msg_ident,
            sector_idx
        },
        content: SystemRegisterCommandContent::WriteProc {
            timestamp,
            write_rank,
            data_to_write: SectorVec(sector.clone()),
        },
    });
    let mut sink: Vec<u8> = Vec::new();

    // when
    serialize_register_command(&register_cmd, &mut sink, &CUSTOM_HMAC_SYSTEM_KEY)
        .await
        .expect("Could not serialize?");

    assert_eq!(sink, CUSTOM_WRITE_PROC.to_vec());
}

#[tokio::test]
#[timeout(200)]
async fn ack_serialized_correctly() {
    // given
    let process_identifier = 205_u8;
    let msg_ident = Uuid::from_bytes(CUSTOM_UUID_BYTES);
    let sector_idx = 1615701_u64;
    let register_cmd = RegisterCommand::System(SystemRegisterCommand {
        header: SystemCommandHeader {
            process_identifier,
            msg_ident,
            sector_idx
        },
        content: SystemRegisterCommandContent::Ack,
    });
    let mut sink: Vec<u8> = Vec::new();

    // when
    serialize_register_command(&register_cmd, &mut sink, &CUSTOM_HMAC_SYSTEM_KEY)
        .await
        .expect("Could not serialize?");

    assert_eq!(sink, CUSTOM_ACK.to_vec());
}

async fn assert_hmac_invalid(msg: &[u8]) {
    let mut slice: &[u8] = &msg[..];
    let data_read: &mut (dyn tokio::io::AsyncRead + Send + Unpin) = &mut slice;
    let (_, hmac_valid) =
        deserialize_register_command(data_read, &CUSTOM_HMAC_SYSTEM_KEY, &CUSTOM_HMAC_CLIENT_KEY)
            .await
            .expect("Could not deserialize");

    assert_false!(hmac_valid);
}

#[tokio::test]
#[timeout(200)]
async fn invalid_hmac_after_tag_alteration() {
    let mut msgs = vec![
        CUSTOM_READ.to_vec(),
        CUSTOM_WRITE.to_vec(),
        CUSTOM_READ_PROC.to_vec(),
        CUSTOM_VALUE.to_vec(),
        CUSTOM_WRITE_PROC.to_vec(),
        CUSTOM_ACK.to_vec(),
    ];

    for msg in &mut msgs {
        let index = msg.len() - 7;
        msg[index] = 115_u8;
        assert_hmac_invalid(&msg).await;
    }
}

#[tokio::test]
#[timeout(200)]
async fn invalid_hmac_after_content_alteration() {
    let mut msgs = vec![
        CUSTOM_READ.to_vec(),
        CUSTOM_WRITE.to_vec(),
        CUSTOM_READ_PROC.to_vec(),
        CUSTOM_VALUE.to_vec(),
        CUSTOM_WRITE_PROC.to_vec(),
        CUSTOM_ACK.to_vec(),
    ];

    for msg in &mut msgs {
        msg[12] = 115_u8;
        assert_hmac_invalid(&msg).await;
    }
}

#[tokio::test]
#[timeout(200)]
async fn error_on_closed_stream_before_full_message_is_delivered() {
    let mut msgs = vec![
        CUSTOM_READ.to_vec(),
        CUSTOM_WRITE.to_vec(),
        CUSTOM_READ_PROC.to_vec(),
        CUSTOM_VALUE.to_vec(),
        CUSTOM_WRITE_PROC.to_vec(),
        CUSTOM_ACK.to_vec(),
    ];

    for msg in &mut msgs {
        for i in 0..msg.len() {
            let mut slice: &[u8] = &msg[..i];
            let data_read: &mut (dyn tokio::io::AsyncRead + Send + Unpin) = &mut slice;
            let result =
                deserialize_register_command(data_read, &CUSTOM_HMAC_SYSTEM_KEY, &CUSTOM_HMAC_CLIENT_KEY)
                    .await;

            assert!(result.is_err());
        }

        let mut slice: &[u8] = &msg[..];
        let data_read: &mut (dyn tokio::io::AsyncRead + Send + Unpin) = &mut slice;
        let (_, hmac_valid) =
            deserialize_register_command(data_read, &CUSTOM_HMAC_SYSTEM_KEY, &CUSTOM_HMAC_CLIENT_KEY)
                .await
                .expect("Could not deserialize");

        assert!(hmac_valid);
    }
}

#[tokio::test]
#[timeout(200)]
async fn incorrect_message_type_discards_8_bytes_1() {
    let mut msgs = vec![
        CUSTOM_READ.to_vec(),
        CUSTOM_WRITE.to_vec(),
        CUSTOM_READ_PROC.to_vec(),
        CUSTOM_VALUE.to_vec(),
        CUSTOM_WRITE_PROC.to_vec(),
        CUSTOM_ACK.to_vec(),
    ];

    for msg in &mut msgs {
        // Prepend valid message with 4 bytes of MAGIC_NUMBER.
        // Even though the stream contains a valid message, deserialization
        // should not detect it, because after reading MAGIC_NUMBER, we
        // encounter incorrect message type (4th byte of magic in actual messages)
        // and so 8 bytes in total should be discarded, which leaves the message
        // without magic.
        let mut new_msg = MAGIC_NUMBER.to_vec();
        new_msg.extend_from_slice(&msg[..]);
        let msg = new_msg;

        let mut slice: &[u8] = &msg[..];
        let data_read: &mut (dyn tokio::io::AsyncRead + Send + Unpin) = &mut slice;
        let result =
            deserialize_register_command(data_read, &CUSTOM_HMAC_SYSTEM_KEY, &CUSTOM_HMAC_CLIENT_KEY)
                .await;

        assert!(result.is_err());
    }
}

#[tokio::test]
#[timeout(200)]
async fn incorrect_message_type_discards_8_bytes_2() {
    // A twist on the _1 test, where we append a correct message to the end
    // and expect the deserializer to detect it.
    let mut new_msg = MAGIC_NUMBER.to_vec();
    new_msg.extend(CUSTOM_READ_PROC);
    new_msg.extend(CUSTOM_WRITE_PROC);
    let msg = new_msg;

    let mut slice: &[u8] = &msg[..];
    let data_read: &mut (dyn tokio::io::AsyncRead + Send + Unpin) = &mut slice;
    let (deserialized, hmac_valid) =
        deserialize_register_command(data_read, &CUSTOM_HMAC_SYSTEM_KEY, &CUSTOM_HMAC_CLIENT_KEY)
            .await
            .expect("Could not deserialize");

    assert!(hmac_valid);

    let mut sink: Vec<u8> = Vec::new();

    serialize_register_command(&deserialized, &mut sink, &CUSTOM_HMAC_SYSTEM_KEY)
        .await
        .expect("Could not serialize?");

    assert_eq!(sink, CUSTOM_WRITE_PROC.to_vec());
}

#[tokio::test]
#[timeout(200)]
async fn deserializes_message_prepended_with_trash_bytes() {
    let mut new_msg: Vec<u8> = vec![213, 111, 192, 57, 93, 1, 14];
    new_msg.extend(CUSTOM_WRITE_PROC);
    let msg = new_msg;

    let mut slice: &[u8] = &msg[..];
    let data_read: &mut (dyn tokio::io::AsyncRead + Send + Unpin) = &mut slice;
    let (deserialized, hmac_valid) =
        deserialize_register_command(data_read, &CUSTOM_HMAC_SYSTEM_KEY, &CUSTOM_HMAC_CLIENT_KEY)
            .await
            .expect("Could not deserialize");

    assert!(hmac_valid);

    let mut sink: Vec<u8> = Vec::new();

    serialize_register_command(&deserialized, &mut sink, &CUSTOM_HMAC_SYSTEM_KEY)
        .await
        .expect("Could not serialize?");

    assert_eq!(sink, CUSTOM_WRITE_PROC.to_vec());
}

#[tokio::test]
#[timeout(200)]
async fn error_on_no_magic_number() {
    let mut msg = CUSTOM_WRITE_PROC.to_vec();
    msg[0] = 1;
    msg[1] = 2;
    msg[2] = 3;
    msg[3] = 4;

    let mut slice: &[u8] = &msg[..];
    let data_read: &mut (dyn tokio::io::AsyncRead + Send + Unpin) = &mut slice;
    let result =
        deserialize_register_command(data_read, &CUSTOM_HMAC_SYSTEM_KEY, &CUSTOM_HMAC_CLIENT_KEY)
            .await;

    assert!(result.is_err());
}

#[tokio::test]
#[timeout(200)]
async fn tcp_4_messages_interleaved_with_trash_bytes() {
    let listener = TcpListener::bind("127.0.0.1:20137")
        .await
        .expect("Could not bind");
    let local_addr = listener.local_addr().expect("Could not get local addr");

    tokio::spawn(async move {
        let mut stream = TcpStream::connect(local_addr).await.unwrap();

        let mut bytes_to_send: Vec<u8> = vec![1, 2, 3, 4, 5];
        bytes_to_send.extend(CUSTOM_READ_PROC);
        bytes_to_send.extend([6, 7, 8]);
        bytes_to_send.extend(CUSTOM_WRITE_PROC);
        bytes_to_send.extend(CUSTOM_ACK);
        bytes_to_send.extend([9, 10, 11]);
        bytes_to_send.extend(CUSTOM_VALUE);
        bytes_to_send.extend([12]);

        stream.write_all(&bytes_to_send).await.unwrap();
    });

    // Accept the connection and read data
    let (socket, _) = listener.accept().await.expect("Could not accept tcp");
    let (mut reader, _) = socket.into_split();

    let (deserialized, hmac_valid) =
        deserialize_register_command(&mut reader, &CUSTOM_HMAC_SYSTEM_KEY, &CUSTOM_HMAC_CLIENT_KEY)
            .await
            .expect("Could not deserialize");
    assert!(hmac_valid);
    let mut sink: Vec<u8> = Vec::new();
    serialize_register_command(&deserialized, &mut sink, &CUSTOM_HMAC_SYSTEM_KEY)
        .await
        .expect("Could not serialize?");
    assert_eq!(sink, CUSTOM_READ_PROC.to_vec());

    let (deserialized, hmac_valid) =
        deserialize_register_command(&mut reader, &CUSTOM_HMAC_SYSTEM_KEY, &CUSTOM_HMAC_CLIENT_KEY)
            .await
            .expect("Could not deserialize");
    assert!(hmac_valid);
    let mut sink: Vec<u8> = Vec::new();
    serialize_register_command(&deserialized, &mut sink, &CUSTOM_HMAC_SYSTEM_KEY)
        .await
        .expect("Could not serialize?");
    assert_eq!(sink, CUSTOM_WRITE_PROC.to_vec());

    let (deserialized, hmac_valid) =
        deserialize_register_command(&mut reader, &CUSTOM_HMAC_SYSTEM_KEY, &CUSTOM_HMAC_CLIENT_KEY)
            .await
            .expect("Could not deserialize");
    assert!(hmac_valid);
    let mut sink: Vec<u8> = Vec::new();
    serialize_register_command(&deserialized, &mut sink, &CUSTOM_HMAC_SYSTEM_KEY)
        .await
        .expect("Could not serialize?");
    assert_eq!(sink, CUSTOM_ACK.to_vec());

    let (deserialized, hmac_valid) =
        deserialize_register_command(&mut reader, &CUSTOM_HMAC_SYSTEM_KEY, &CUSTOM_HMAC_CLIENT_KEY)
            .await
            .expect("Could not deserialize");
    assert!(hmac_valid);
    let mut sink: Vec<u8> = Vec::new();
    serialize_register_command(&deserialized, &mut sink, &CUSTOM_HMAC_SYSTEM_KEY)
        .await
        .expect("Could not serialize?");
    assert_eq!(sink, CUSTOM_VALUE.to_vec());

    let result =
        deserialize_register_command(&mut reader, &CUSTOM_HMAC_SYSTEM_KEY, &CUSTOM_HMAC_CLIENT_KEY)
            .await;
    assert!(result.is_err());
}